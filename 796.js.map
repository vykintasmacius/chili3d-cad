{"version":3,"file":"796.js","sources":["webpack://chili3d/./packages/chili-ui/src/dialog.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/treeItem.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/treeItemGroup.ts","webpack://chili3d/./packages/chili-ui/src/project/toolBar.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/treeModel.ts","webpack://chili3d/./packages/chili-ui/src/project/tree/tree.ts","webpack://chili3d/./packages/chili-ui/src/project/projectView.ts","webpack://chili3d/./packages/chili-ui/src/property/propertyBase.ts","webpack://chili3d/./packages/chili-ui/src/property/input.ts","webpack://chili3d/./packages/chili-ui/src/property/matrixProperty.ts","webpack://chili3d/./packages/chili-ui/src/property/check.ts","webpack://chili3d/./packages/chili-ui/src/property/colorProperty.ts","webpack://chili3d/./packages/chili-ui/src/property/material/textureEditor.ts","webpack://chili3d/./packages/chili-ui/src/property/materialProperty.ts","webpack://chili3d/./packages/chili-ui/src/property/utils.ts","webpack://chili3d/./packages/chili-ui/src/property/propertyView.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/commandContext.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbonButton.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbonStack.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbon.ts","webpack://chili3d/./packages/chili-ui/src/ribbon/ribbonData.ts","webpack://chili3d/./packages/chili-ui/src/statusbar/snapConfig.ts","webpack://chili3d/./packages/chili-ui/src/statusbar/statusbar.ts","webpack://chili3d/./packages/chili-ui/src/cursor/index.ts","webpack://chili3d/./packages/chili-ui/src/property/material/materialDataContent.ts","webpack://chili3d/./packages/chili-ui/src/property/material/materialEditor.ts","webpack://chili3d/./packages/chili-ui/src/viewport/okCancel.ts","webpack://chili3d/./packages/chili-ui/src/viewport/flyout/input.ts","webpack://chili3d/./packages/chili-ui/src/viewport/flyout/tip.ts","webpack://chili3d/./packages/chili-ui/src/viewport/flyout/flyout.ts","webpack://chili3d/./packages/chili-ui/src/viewport/viewport.ts","webpack://chili3d/./packages/chili-ui/src/viewport/layoutViewport.ts","webpack://chili3d/./packages/chili-ui/src/editor.ts","webpack://chili3d/./packages/chili-ui/src/home/languageSelector.ts","webpack://chili3d/./packages/chili-ui/src/home/home.ts","webpack://chili3d/./packages/chili-ui/src/permanent.ts","webpack://chili3d/./packages/chili-ui/src/toast/toast.ts","webpack://chili3d/./packages/chili-ui/src/mainWindow.ts"],"sourcesContent":["// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { button, div } from \"chili-controls\";\r\nimport { DialogResult, I18n, I18nKeys } from \"chili-core\";\r\nimport style from \"./dialog.module.css\";\r\n\r\nexport class Dialog {\r\n    private constructor() {}\r\n\r\n    static show(title: I18nKeys, content: HTMLElement, callback?: (result: DialogResult) => void) {\r\n        const dialog = document.createElement(\"dialog\");\r\n        document.body.appendChild(dialog);\r\n\r\n        dialog.appendChild(\r\n            div(\r\n                { className: style.root },\r\n                div({ className: style.title }, I18n.translate(title) ?? \"chili3d\"),\r\n                div({ className: style.content }, content),\r\n                div(\r\n                    { className: style.buttons },\r\n                    button({\r\n                        textContent: I18n.translate(\"common.confirm\"),\r\n                        onclick: () => {\r\n                            dialog.remove();\r\n                            callback?.(DialogResult.ok);\r\n                        },\r\n                    }),\r\n                    button({\r\n                        textContent: I18n.translate(\"common.cancel\"),\r\n                        onclick: () => {\r\n                            dialog.remove();\r\n                            callback?.(DialogResult.cancel);\r\n                        },\r\n                    }),\r\n                ),\r\n            ),\r\n        );\r\n\r\n        dialog.showModal();\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { label, setSVGIcon, svg } from \"chili-controls\";\r\nimport { Binding, IDocument, INode, Transaction } from \"chili-core\";\r\nimport style from \"./treeItem.module.css\";\r\n\r\nexport abstract class TreeItem extends HTMLElement {\r\n    readonly name: HTMLLabelElement;\r\n    readonly visibleIcon: SVGSVGElement;\r\n\r\n    private _node: INode;\r\n    get node() {\r\n        return this._node;\r\n    }\r\n\r\n    constructor(\r\n        private document: IDocument,\r\n        node: INode,\r\n    ) {\r\n        super();\r\n        this._node = node;\r\n        this.draggable = true;\r\n        this.name = label({\r\n            className: style.name,\r\n            textContent: new Binding(node, \"name\"),\r\n        });\r\n        this.visibleIcon = svg({\r\n            className: style.icon,\r\n            icon: this.getVisibleIcon(),\r\n            onclick: this.onVisibleIconClick,\r\n        });\r\n        this.setVisibleStyle(node.parentVisible);\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        this.node.onPropertyChanged(this.onPropertyChanged);\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        this.node.removePropertyChanged(this.onPropertyChanged);\r\n    }\r\n\r\n    private readonly onPropertyChanged = (property: keyof INode, model: INode) => {\r\n        if (property === \"visible\") {\r\n            setSVGIcon(this.visibleIcon, this.getVisibleIcon());\r\n        } else if (property === \"parentVisible\") {\r\n            this.setVisibleStyle(model[property]);\r\n        }\r\n    };\r\n\r\n    private setVisibleStyle(parentVisible?: boolean) {\r\n        if (parentVisible === true) {\r\n            this.visibleIcon.classList.remove(style[\"parent-hidden\"]);\r\n        } else {\r\n            this.visibleIcon.classList.add(style[\"parent-hidden\"]);\r\n        }\r\n    }\r\n\r\n    addSelectedStyle(style: string) {\r\n        this.getSelectedHandler().classList.add(style);\r\n    }\r\n\r\n    removeSelectedStyle(style: string) {\r\n        this.getSelectedHandler().classList.remove(style);\r\n    }\r\n\r\n    abstract getSelectedHandler(): HTMLElement;\r\n\r\n    dispose() {\r\n        this.remove();\r\n        this.node.removePropertyChanged(this.onPropertyChanged);\r\n        this.visibleIcon.removeEventListener(\"click\", this.onVisibleIconClick);\r\n        this.document = null as any;\r\n        this._node = null as any;\r\n    }\r\n\r\n    private getVisibleIcon() {\r\n        return this.node.visible ? \"icon-eye\" : \"icon-eye-slash\";\r\n    }\r\n\r\n    private readonly onVisibleIconClick = (e: MouseEvent) => {\r\n        e.stopPropagation();\r\n        Transaction.execute(this.document, \"change visible\", () => {\r\n            this.node.visible = !this.node.visible;\r\n        });\r\n        this.document.visual.update();\r\n    };\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, setSVGIcon, svg } from \"chili-controls\";\r\nimport { IDocument, INodeLinkedList } from \"chili-core\";\r\nimport { TreeItem } from \"./treeItem\";\r\nimport style from \"./treeItemGroup.module.css\";\r\n\r\nexport class TreeGroup extends TreeItem {\r\n    private _isExpanded = true;\r\n    readonly header: HTMLElement;\r\n    readonly items: HTMLDivElement = div({ className: `${style.container} ${style.left16px}` });\r\n    readonly expanderIcon: SVGSVGElement;\r\n\r\n    constructor(document: IDocument, node: INodeLinkedList) {\r\n        super(document, node);\r\n        this.expanderIcon = svg({\r\n            icon: this.getExpanderIcon(),\r\n            className: style.expanderIcon,\r\n            onclick: this.handleExpanderClick,\r\n        });\r\n        this.header = div(\r\n            { className: `${style.row} ${style.header}` },\r\n            this.expanderIcon,\r\n            this.name,\r\n            this.visibleIcon,\r\n        );\r\n        super.append(div({ className: style.container }, this.header, this.items));\r\n    }\r\n\r\n    get isExpanded(): boolean {\r\n        return this._isExpanded;\r\n    }\r\n\r\n    set isExpanded(value: boolean) {\r\n        this._isExpanded = value;\r\n        setSVGIcon(this.expanderIcon, this.getExpanderIcon());\r\n        this.items.classList.toggle(style.hide, !this._isExpanded);\r\n    }\r\n\r\n    getSelectedHandler(): HTMLElement {\r\n        return this.header;\r\n    }\r\n\r\n    override dispose() {\r\n        super.dispose();\r\n        this.header.remove();\r\n        this.expanderIcon.removeEventListener(\"click\", this.handleExpanderClick);\r\n    }\r\n\r\n    private readonly handleExpanderClick = (e: MouseEvent) => {\r\n        e.stopPropagation();\r\n        this.isExpanded = !this._isExpanded;\r\n    };\r\n\r\n    private getExpanderIcon() {\r\n        return this._isExpanded ? \"icon-angle-down\" : \"icon-angle-right\";\r\n    }\r\n\r\n    override appendChild<T extends Node>(node: T): T {\r\n        this.items.appendChild(node);\r\n        return node;\r\n    }\r\n\r\n    override append(...nodes: Node[]): void {\r\n        this.items.append(...nodes);\r\n    }\r\n\r\n    override removeChild<T extends Node>(child: T): T {\r\n        if (child.parentNode === this.items) this.items.removeChild(child);\r\n        return child;\r\n    }\r\n\r\n    addItem(...items: Node[]) {\r\n        this.items.append(...items);\r\n        return this;\r\n    }\r\n\r\n    insertAfter(item: TreeItem, child: TreeItem | null): void {\r\n        const referenceNode = child ? child.nextSibling : this.items.firstChild;\r\n        this.items.insertBefore(item, referenceNode);\r\n    }\r\n}\r\n\r\ncustomElements.define(\"tree-group\", TreeGroup);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { a, svg } from \"chili-controls\";\r\nimport { I18n, I18nKeys, INode, PubSub } from \"chili-core\";\r\nimport { ProjectView } from \"./projectView\";\r\nimport style from \"./toolBar.module.css\";\r\nimport { Tree } from \"./tree\";\r\nimport { TreeGroup } from \"./tree/treeItemGroup\";\r\n\r\nexport class ToolBar extends HTMLElement {\r\n    constructor(readonly projectView: ProjectView) {\r\n        super();\r\n        this.className = style.panel;\r\n        this.render();\r\n    }\r\n\r\n    private render() {\r\n        const buttons = [\r\n            { icon: \"icon-folder-plus\", tip: \"items.tool.newFolder\", command: this.newGroup },\r\n            { icon: \"icon-unexpand\", tip: \"items.tool.unexpandAll\", command: this.unExpandAll },\r\n            { icon: \"icon-expand\", tip: \"items.tool.expandAll\", command: this.expandAll },\r\n        ];\r\n        buttons.forEach(({ icon, tip, command }) => this.button(icon, tip as I18nKeys, command));\r\n    }\r\n\r\n    private button(icon: string, tip: I18nKeys, command: () => void) {\r\n        this.append(\r\n            a(\r\n                { title: I18n.translate(tip) },\r\n                svg({\r\n                    icon,\r\n                    className: style.svg,\r\n                    onclick: command,\r\n                }),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private readonly newGroup = () => {\r\n        PubSub.default.pub(\"executeCommand\", \"create.folder\");\r\n    };\r\n\r\n    private readonly expandAll = () => {\r\n        this.setExpand(true);\r\n    };\r\n\r\n    private readonly unExpandAll = () => {\r\n        this.setExpand(false);\r\n    };\r\n\r\n    private setExpand(expand: boolean) {\r\n        let tree = this.projectView.activeTree();\r\n        if (!tree) return;\r\n        let first = this.projectView.activeDocument?.rootNode.firstChild;\r\n        if (first) this.setNodeExpand(tree, first, expand);\r\n    }\r\n\r\n    private setNodeExpand(tree: Tree, list: INode, expand: boolean) {\r\n        let item = tree.treeItem(list);\r\n        if (item instanceof TreeGroup) {\r\n            item.isExpanded = expand;\r\n        }\r\n        if (INode.isLinkedListNode(list) && list.firstChild) {\r\n            this.setNodeExpand(tree, list.firstChild, expand);\r\n        }\r\n        if (list.nextSibling) {\r\n            this.setNodeExpand(tree, list.nextSibling, expand);\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-toolbar\", ToolBar);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { IDocument, INode } from \"chili-core\";\r\nimport { TreeItem } from \"./treeItem\";\r\nimport style from \"./treeModel.module.css\";\r\n\r\nexport class TreeModel extends TreeItem {\r\n    constructor(document: IDocument, node: INode) {\r\n        super(document, node);\r\n        this.append(this.name, this.visibleIcon);\r\n        this.classList.add(style.panel);\r\n    }\r\n\r\n    getSelectedHandler(): HTMLElement {\r\n        return this;\r\n    }\r\n}\r\n\r\ncustomElements.define(\"tree-model\", TreeModel);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport {\r\n    IDocument,\r\n    INode,\r\n    INodeChangedObserver,\r\n    INodeLinkedList,\r\n    NodeRecord,\r\n    PubSub,\r\n    ShapeType,\r\n    Transaction,\r\n    VisualNode,\r\n} from \"chili-core\";\r\nimport { NodeSelectionHandler, ShapeSelectionHandler } from \"chili-vis\";\r\nimport style from \"./tree.module.css\";\r\nimport { TreeItem } from \"./treeItem\";\r\nimport { TreeGroup } from \"./treeItemGroup\";\r\nimport { TreeModel } from \"./treeModel\";\r\n\r\nexport class Tree extends HTMLElement implements INodeChangedObserver {\r\n    private readonly nodeMap = new Map<INode, TreeItem>();\r\n    private lastClicked: INode | undefined;\r\n    private readonly selectedNodes: Set<INode> = new Set();\r\n    private dragging: INode[] | undefined;\r\n\r\n    constructor(private document: IDocument) {\r\n        super();\r\n        this.className = style.panel;\r\n        this.initializeTree(document);\r\n    }\r\n\r\n    private initializeTree(document: IDocument) {\r\n        this.addAllNodes(document, this, document.rootNode);\r\n        this.addEvents(this);\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.document.addNodeObserver(this);\r\n        PubSub.default.sub(\"selectionChanged\", this.handleSelectionChanged);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.document.removeNodeObserver(this);\r\n        PubSub.default.remove(\"selectionChanged\", this.handleSelectionChanged);\r\n    }\r\n\r\n    treeItem(node: INode): TreeItem | undefined {\r\n        return this.nodeMap.get(node);\r\n    }\r\n\r\n    dispose(): void {\r\n        this.lastClicked = undefined;\r\n        this.dragging = undefined;\r\n        this.nodeMap.forEach((x) => x.dispose());\r\n        this.nodeMap.clear();\r\n        this.selectedNodes.clear();\r\n        this.removeEvents(this);\r\n        this.document.removeNodeObserver(this);\r\n        PubSub.default.remove(\"selectionChanged\", this.handleSelectionChanged);\r\n        this.document = null as any;\r\n    }\r\n\r\n    handleNodeChanged(records: NodeRecord[]) {\r\n        this.ensureHasHTML(records);\r\n        records.forEach((record) => {\r\n            const ele = this.nodeMap.get(record.node);\r\n            ele?.remove();\r\n            if (!ele || !record.newParent) return;\r\n\r\n            let parent = this.nodeMap.get(record.newParent) || this.createAndMapParent(record.newParent);\r\n            if (parent instanceof TreeGroup) {\r\n                const pre = record.newPrevious ? this.nodeMap.get(record.newPrevious) : null;\r\n                parent.insertAfter(ele, pre ?? null);\r\n            }\r\n        });\r\n    }\r\n\r\n    private createAndMapParent(newParent: INode) {\r\n        const parent = this.createHTMLElement(this.document, newParent);\r\n        this.nodeMap.set(newParent, parent);\r\n        return parent;\r\n    }\r\n\r\n    private readonly handleSelectionChanged = (\r\n        document: IDocument,\r\n        selected: INode[],\r\n        unselected: INode[],\r\n    ) => {\r\n        unselected.forEach((x) => {\r\n            this.nodeMap.get(x)?.removeSelectedStyle(style.selected);\r\n            this.selectedNodes.delete(x);\r\n        });\r\n        this.setLastClickItem(undefined);\r\n        selected.forEach((model) => {\r\n            this.selectedNodes.add(model);\r\n            this.nodeMap.get(model)?.addSelectedStyle(style.selected);\r\n        });\r\n        this.scrollToNode(selected);\r\n    };\r\n\r\n    private ensureHasHTML(records: NodeRecord[]) {\r\n        records.forEach((record) => {\r\n            if (!this.nodeMap.has(record.node)) {\r\n                this.nodeMap.set(record.node, this.createHTMLElement(this.document, record.node));\r\n            }\r\n        });\r\n    }\r\n\r\n    private scrollToNode(selected: INode[]) {\r\n        const node = selected.at(0);\r\n        if (node) {\r\n            this.expandParents(node);\r\n            this.nodeMap.get(node)?.scrollIntoView({ block: \"nearest\", behavior: \"smooth\" });\r\n        }\r\n    }\r\n\r\n    private expandParents(node: INode) {\r\n        let parent = node.parent;\r\n        while (parent) {\r\n            const group = this.nodeMap.get(parent) as TreeGroup;\r\n            if (group && !group.isExpanded) {\r\n                group.isExpanded = true;\r\n            }\r\n            parent = parent.parent;\r\n        }\r\n    }\r\n\r\n    private addAllNodes(document: IDocument, parent: HTMLElement, node: INode) {\r\n        const element = this.createHTMLElement(document, node);\r\n        this.nodeMap.set(node, element);\r\n        parent.appendChild(element);\r\n\r\n        const firstChild = (node as INodeLinkedList).firstChild;\r\n        if (firstChild) this.addAllNodes(document, element, firstChild);\r\n        if (node.nextSibling) this.addAllNodes(document, parent, node.nextSibling);\r\n    }\r\n\r\n    private createHTMLElement(document: IDocument, node: INode): TreeItem {\r\n        let result: TreeItem;\r\n        if (INode.isLinkedListNode(node)) result = new TreeGroup(document, node);\r\n        else if (node instanceof VisualNode) result = new TreeModel(document, node);\r\n        else throw new Error(\"unknown node\");\r\n        return result;\r\n    }\r\n\r\n    private addEvents(item: HTMLElement) {\r\n        item.addEventListener(\"dragstart\", this.onDragStart);\r\n        item.addEventListener(\"dragover\", this.onDragOver);\r\n        item.addEventListener(\"dragleave\", this.onDragLeave);\r\n        item.addEventListener(\"drop\", this.onDrop);\r\n        item.addEventListener(\"click\", this.onClick);\r\n    }\r\n\r\n    private removeEvents(item: HTMLElement) {\r\n        item.removeEventListener(\"dragstart\", this.onDragStart);\r\n        item.removeEventListener(\"dragover\", this.onDragOver);\r\n        item.removeEventListener(\"dragleave\", this.onDragLeave);\r\n        item.removeEventListener(\"drop\", this.onDrop);\r\n        item.removeEventListener(\"click\", this.onClick);\r\n    }\r\n\r\n    private getTreeItem(item: HTMLElement | null): TreeItem | undefined {\r\n        if (item === null) return undefined;\r\n        if (item instanceof TreeItem) return item;\r\n        return this.getTreeItem(item.parentElement);\r\n    }\r\n\r\n    private readonly onClick = (event: MouseEvent) => {\r\n        if (!this.canSelect()) return;\r\n\r\n        const item = this.getTreeItem(event.target as HTMLElement)?.node;\r\n        if (!item) return;\r\n        event.stopPropagation();\r\n\r\n        if (event.shiftKey) {\r\n            this.handleShiftClick(item);\r\n        } else {\r\n            this.document.selection.setSelection([item], event.ctrlKey);\r\n        }\r\n\r\n        this.setLastClickItem(item);\r\n    };\r\n\r\n    private handleShiftClick(item: INode) {\r\n        if (this.lastClicked) {\r\n            const nodes = INode.getNodesBetween(this.lastClicked, item);\r\n            this.document.selection.setSelection(nodes, false);\r\n        }\r\n    }\r\n\r\n    private readonly onDragLeave = (event: DragEvent) => {\r\n        if (!this.canDrop(event)) return;\r\n    };\r\n\r\n    private readonly onDragOver = (event: DragEvent) => {\r\n        if (!this.canDrop(event)) {\r\n            return;\r\n        }\r\n        event.preventDefault();\r\n        event.dataTransfer!.dropEffect = \"move\";\r\n    };\r\n\r\n    private canSelect() {\r\n        if (this.document.visual.eventHandler instanceof NodeSelectionHandler) {\r\n            return true;\r\n        }\r\n\r\n        if (this.document.visual.eventHandler instanceof ShapeSelectionHandler) {\r\n            return this.document.visual.eventHandler.shapeType === ShapeType.Shape;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    private setLastClickItem(item: INode | undefined) {\r\n        if (this.lastClicked !== undefined) {\r\n            this.nodeMap.get(this.lastClicked)?.removeSelectedStyle(style.current);\r\n        }\r\n        this.lastClicked = item;\r\n        if (item !== undefined) {\r\n            this.nodeMap.get(item)?.addSelectedStyle(style.current);\r\n            this.document.currentNode = INode.isLinkedListNode(item) ? item : item.parent;\r\n        }\r\n    }\r\n\r\n    private canDrop(event: DragEvent) {\r\n        let node = this.getTreeItem(event.target as HTMLElement)?.node;\r\n        if (node === undefined) return false;\r\n        if (this.dragging?.includes(node)) return false;\r\n        let parent = node.parent;\r\n        while (parent !== undefined) {\r\n            if (this.dragging?.includes(parent)) return false;\r\n            parent = parent.parent;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    protected onDrop = (event: DragEvent) => {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        let node = this.getTreeItem(event.target as HTMLElement)?.node;\r\n        if (node === undefined) return;\r\n        Transaction.execute(this.document, \"move node\", () => {\r\n            let isLinkList = INode.isLinkedListNode(node);\r\n            let newParent = isLinkList ? (node as INodeLinkedList) : node.parent;\r\n            let target = isLinkList ? undefined : node;\r\n            this.dragging?.forEach((x) => {\r\n                x.parent?.move(x, newParent!, target);\r\n            });\r\n            this.dragging = undefined;\r\n        });\r\n    };\r\n\r\n    private readonly onDragStart = (event: DragEvent) => {\r\n        event.stopPropagation();\r\n        const item = this.getTreeItem(event.target as HTMLElement)?.node;\r\n        this.dragging = INode.findTopLevelNodes(this.selectedNodes);\r\n        if (item && !INode.containsDescendant(this.selectedNodes, item)) {\r\n            this.dragging.push(item);\r\n        }\r\n    };\r\n}\r\n\r\ncustomElements.define(\"ui-tree\", Tree);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, span } from \"chili-controls\";\r\nimport { IDocument, IView, Localize, PubSub } from \"chili-core\";\r\nimport style from \"./projectView.module.css\";\r\nimport { ToolBar } from \"./toolBar\";\r\nimport { Tree } from \"./tree\";\r\n\r\nexport class ProjectView extends HTMLElement {\r\n    private readonly _documentTreeMap = new Map<IDocument, Tree>();\r\n\r\n    private _activeDocument: IDocument | undefined;\r\n    get activeDocument() {\r\n        return this._activeDocument;\r\n    }\r\n\r\n    private readonly panel: HTMLDivElement;\r\n\r\n    constructor(props: { className: string }) {\r\n        super();\r\n        this.classList.add(style.root, props.className);\r\n        this.panel = div({\r\n            className: style.itemsPanel,\r\n        });\r\n        PubSub.default.sub(\"activeViewChanged\", this.handleActiveViewChanged);\r\n        PubSub.default.sub(\"documentClosed\", this.handleDocumentClosed);\r\n\r\n        this.render();\r\n    }\r\n\r\n    private render() {\r\n        this.append(\r\n            div(\r\n                { className: style.headerPanel },\r\n                span({\r\n                    className: style.header,\r\n                    textContent: new Localize(\"items.header\"),\r\n                }),\r\n                new ToolBar(this),\r\n            ),\r\n            this.panel,\r\n        );\r\n    }\r\n\r\n    activeTree() {\r\n        if (!this._activeDocument) return undefined;\r\n        return this._documentTreeMap.get(this._activeDocument);\r\n    }\r\n\r\n    private readonly handleDocumentClosed = (document: IDocument) => {\r\n        const tree = this._documentTreeMap.get(document);\r\n        if (tree) {\r\n            tree.remove();\r\n            tree.dispose();\r\n            this._documentTreeMap.delete(document);\r\n        }\r\n    };\r\n\r\n    private readonly handleActiveViewChanged = (view: IView | undefined) => {\r\n        if (this._activeDocument === view?.document) return;\r\n\r\n        this._documentTreeMap.get(this._activeDocument!)?.remove();\r\n        this._activeDocument = view?.document;\r\n\r\n        if (view) {\r\n            let tree = this._documentTreeMap.get(view.document);\r\n            if (!tree) {\r\n                tree = new Tree(view.document);\r\n                this._documentTreeMap.set(view.document, tree);\r\n            }\r\n            this.panel.append(tree);\r\n        }\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-project-view\", ProjectView);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport style from \"./propertyBase.module.css\";\r\n\r\nexport abstract class PropertyBase extends HTMLElement {\r\n    constructor(readonly objects: any[]) {\r\n        super();\r\n        this.className = style.panel;\r\n        if (objects.length === 0) {\r\n            throw new Error(`there are no objects`);\r\n        }\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport {\r\n    div,\r\n    input,\r\n    NumberConverter,\r\n    span,\r\n    StringConverter,\r\n    XYConverter,\r\n    XYZConverter,\r\n} from \"chili-controls\";\r\nimport {\r\n    Binding,\r\n    IConverter,\r\n    IDocument,\r\n    isPropertyChanged,\r\n    Localize,\r\n    Property,\r\n    PubSub,\r\n    Result,\r\n    Transaction,\r\n    XY,\r\n    XYZ,\r\n} from \"chili-core\";\r\nimport commonStyle from \"./common.module.css\";\r\nimport style from \"./input.module.css\";\r\nimport { PropertyBase } from \"./propertyBase\";\r\n\r\nclass ArrayValueConverter implements IConverter {\r\n    constructor(\r\n        readonly objects: any[],\r\n        readonly property: Property,\r\n        readonly converter?: IConverter,\r\n    ) {}\r\n\r\n    convert(value: any): Result<string> {\r\n        return Result.ok(this.getDefaultValue());\r\n    }\r\n\r\n    convertBack?(value: string): Result<any> {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    private getValueString(obj: any): string {\r\n        const value = obj[this.property.name];\r\n        const cvalue = this.converter?.convert(value);\r\n        return cvalue?.isOk ? cvalue.value : String(value);\r\n    }\r\n\r\n    private getDefaultValue() {\r\n        const values = this.objects.map(this.getValueString.bind(this));\r\n        const uniqueValues = new Set(values);\r\n        return uniqueValues.size === 1 ? values[0] : \"\";\r\n    }\r\n}\r\n\r\nexport class InputProperty extends PropertyBase {\r\n    readonly converter: IConverter | undefined;\r\n\r\n    constructor(\r\n        readonly document: IDocument,\r\n        objects: any[],\r\n        readonly property: Property,\r\n        converter?: IConverter,\r\n    ) {\r\n        super(objects);\r\n        this.converter = converter ?? this.getConverter();\r\n        const arrayConverter = new ArrayValueConverter(objects, property, this.converter);\r\n        this.append(\r\n            div(\r\n                { className: commonStyle.panel },\r\n                span({ className: commonStyle.propertyName, textContent: new Localize(property.display) }),\r\n                input({\r\n                    className: style.box,\r\n                    value: new Binding(objects[0], property.name, arrayConverter),\r\n                    readOnly: this.isReadOnly(),\r\n                    onkeydown: this.handleKeyDown,\r\n                    onblur: this.handleBlur,\r\n                }),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private isReadOnly(): boolean {\r\n        let des = Object.getOwnPropertyDescriptor(this.objects[0], this.property.name);\r\n        if (!des) {\r\n            let proto = Object.getPrototypeOf(this.objects[0]);\r\n            while (isPropertyChanged(proto)) {\r\n                des = Object.getOwnPropertyDescriptor(proto, this.property.name);\r\n                if (des) break;\r\n                proto = Object.getPrototypeOf(proto);\r\n            }\r\n        }\r\n        return (\r\n            des?.set === undefined ||\r\n            (this.converter === undefined && typeof this.objects[0][this.property.name] !== \"string\")\r\n        );\r\n    }\r\n\r\n    private readonly handleBlur = (e: FocusEvent) => {\r\n        this.setValue(e.target as HTMLInputElement);\r\n    };\r\n\r\n    private readonly handleKeyDown = (e: KeyboardEvent) => {\r\n        e.stopPropagation();\r\n        if (this.converter && e.key === \"Enter\") {\r\n            this.setValue(e.target as HTMLInputElement);\r\n        }\r\n    };\r\n\r\n    private readonly setValue = (input: HTMLInputElement) => {\r\n        if (this.isReadOnly()) return;\r\n\r\n        const newValue = this.converter?.convertBack?.(input.value);\r\n        if (!newValue?.isOk) {\r\n            PubSub.default.pub(\"showToast\", \"error.default:{0}\", newValue?.error);\r\n            return;\r\n        }\r\n        Transaction.execute(this.document, \"modify property\", () => {\r\n            this.objects.forEach((x) => {\r\n                x[this.property.name] = newValue.value;\r\n            });\r\n            this.document.visual.update();\r\n        });\r\n    };\r\n\r\n    private getConverter(): IConverter | undefined {\r\n        const name = this.objects[0][this.property.name].constructor.name;\r\n        const converters: { [key: string]: () => IConverter } = {\r\n            [XYZ.name]: () => new XYZConverter(),\r\n            [XY.name]: () => new XYConverter(),\r\n            [String.name]: () => new StringConverter(),\r\n            [Number.name]: () => new NumberConverter(),\r\n        };\r\n        return converters[name]?.();\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-input-property\", InputProperty);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { GroupNode, IConverter, IDocument, Matrix4, Result, VisualNode, XYZLike } from \"chili-core\";\r\nimport { InputProperty } from \"./input\";\r\nimport { PropertyBase } from \"./propertyBase\";\r\n\r\nexport class MatrixProperty extends PropertyBase {\r\n    readonly first: VisualNode | GroupNode;\r\n\r\n    constructor(\r\n        readonly document: IDocument,\r\n        geometries: (VisualNode | GroupNode)[],\r\n        className: string,\r\n    ) {\r\n        super(geometries);\r\n        this.first = geometries[0];\r\n        this.className = className;\r\n        this.append(\r\n            new InputProperty(\r\n                document,\r\n                [this.first],\r\n                {\r\n                    name: \"transform\",\r\n                    display: \"transform.translation\",\r\n                },\r\n                new TranslationConverter(this.first),\r\n            ),\r\n            new InputProperty(\r\n                document,\r\n                [this.first],\r\n                {\r\n                    name: \"transform\",\r\n                    display: \"transform.scale\",\r\n                },\r\n                new ScalingConverter(this.first),\r\n            ),\r\n            new InputProperty(\r\n                document,\r\n                [this.first],\r\n                {\r\n                    name: \"transform\",\r\n                    display: \"transform.rotation\",\r\n                },\r\n                new RotateConverter(this.first),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private readonly onPropertyChanged = (property: keyof (VisualNode | GroupNode)) => {\r\n        if (property === \"transform\") {\r\n            this.objects.forEach((obj) => {\r\n                if (obj === this.first) return;\r\n                obj.transform = this.first.transform;\r\n            });\r\n        }\r\n    };\r\n\r\n    connectedCallback() {\r\n        (this.first as VisualNode).onPropertyChanged(this.onPropertyChanged);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        (this.first as VisualNode).removePropertyChanged(this.onPropertyChanged);\r\n    }\r\n}\r\n\r\ncustomElements.define(\"matrix-property\", MatrixProperty);\r\n\r\nexport abstract class MatrixConverter implements IConverter<Matrix4, string> {\r\n    constructor(readonly geometry: VisualNode | GroupNode) {}\r\n\r\n    convert(value: Matrix4): Result<string, string> {\r\n        const [x, y, z] = this.convertFrom(value);\r\n        return Result.ok(`${x.toFixed(6)}, ${y.toFixed(6)}, ${z.toFixed(6)}`);\r\n    }\r\n\r\n    protected abstract convertFrom(value: Matrix4): [number, number, number];\r\n    protected abstract convertTo(values: XYZLike): Matrix4;\r\n\r\n    convertBack(value: string): Result<Matrix4, string> {\r\n        const values = value\r\n            .split(\",\")\r\n            .map(Number)\r\n            .filter((x) => !isNaN(x));\r\n        if (values.length !== 3) return Result.err(\"invalid number of values\");\r\n        const newValue = {\r\n            x: values[0],\r\n            y: values[1],\r\n            z: values[2],\r\n        };\r\n        const matrix = this.convertTo(newValue);\r\n        return Result.ok(matrix);\r\n    }\r\n}\r\n\r\nexport class TranslationConverter extends MatrixConverter {\r\n    protected convertFrom(matrix: Matrix4): [number, number, number] {\r\n        let position = matrix.translationPart();\r\n        return [position.x, position.y, position.z];\r\n    }\r\n    protected convertTo(values: XYZLike): Matrix4 {\r\n        const rotation = this.geometry.transform.getEulerAngles();\r\n        const scale = this.geometry.transform.getScale();\r\n        return Matrix4.createFromTRS(values, rotation, scale);\r\n    }\r\n}\r\n\r\nexport class ScalingConverter extends MatrixConverter {\r\n    protected convertFrom(matrix: Matrix4): [number, number, number] {\r\n        let s = matrix.getScale();\r\n        return [s.x, s.y, s.z];\r\n    }\r\n    protected convertTo(values: XYZLike): Matrix4 {\r\n        const rotation = this.geometry.transform.getEulerAngles();\r\n        const translation = this.geometry.transform.translationPart();\r\n        return Matrix4.createFromTRS(translation, rotation, values);\r\n    }\r\n}\r\n\r\nexport class RotateConverter extends MatrixConverter {\r\n    protected convertFrom(matrix: Matrix4): [number, number, number] {\r\n        let s = matrix.getEulerAngles();\r\n        return [(s.pitch * 180) / Math.PI, (s.yaw * 180) / Math.PI, (s.roll * 180) / Math.PI];\r\n    }\r\n    protected convertTo(values: XYZLike): Matrix4 {\r\n        const scale = this.geometry.transform.getScale();\r\n        const translation = this.geometry.transform.translationPart();\r\n        return Matrix4.createFromTRS(\r\n            translation,\r\n            {\r\n                pitch: (values.x * Math.PI) / 180,\r\n                yaw: (values.y * Math.PI) / 180,\r\n                roll: (values.z * Math.PI) / 180,\r\n            },\r\n            scale,\r\n        );\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { Property } from \"chili-core\";\r\n\r\nimport { PropertyBase } from \"./propertyBase\";\r\n\r\nexport class CheckProperty extends PropertyBase {\r\n    constructor(\r\n        objects: any[],\r\n        readonly property: Property,\r\n    ) {\r\n        super(objects);\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-check-property\", CheckProperty);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { ColorConverter, div, input, label } from \"chili-controls\";\r\nimport { Binding, IDocument, Localize, Property, PubSub, Transaction } from \"chili-core\";\r\nimport colorStyle from \"./colorPorperty.module.css\";\r\nimport commonStyle from \"./common.module.css\";\r\nimport { PropertyBase } from \"./propertyBase\";\r\n\r\nexport class ColorProperty extends PropertyBase {\r\n    readonly converter = new ColorConverter();\r\n    readonly input: HTMLInputElement;\r\n\r\n    constructor(\r\n        readonly document: IDocument,\r\n        objects: any[],\r\n        readonly property: Property,\r\n    ) {\r\n        super(objects);\r\n        this.input = this.createInput(objects[0]);\r\n        this.appendChild(this.createPanel());\r\n    }\r\n\r\n    private createInput(object: any): HTMLInputElement {\r\n        return input({\r\n            className: colorStyle.color,\r\n            type: \"color\",\r\n            value: new Binding(object, this.property.name, this.converter),\r\n            onchange: this.setColor,\r\n        });\r\n    }\r\n\r\n    private createPanel(): HTMLElement {\r\n        return div(\r\n            { className: commonStyle.panel },\r\n            label({\r\n                className: commonStyle.propertyName,\r\n                textContent: new Localize(this.property.display),\r\n            }),\r\n            this.input,\r\n        );\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        this.input.removeEventListener(\"onchange\", this.setColor);\r\n    }\r\n\r\n    private readonly setColor = (e: Event) => {\r\n        const value = (e.target as HTMLInputElement).value;\r\n        const color = this.converter.convertBack(value).value;\r\n        if (color === undefined) {\r\n            PubSub.default.pub(\"showToast\", \"toast.converter.invalidColor\");\r\n            return;\r\n        }\r\n        Transaction.execute(this.document, \"change color\", () => {\r\n            this.objects.forEach((x) => {\r\n                x[this.property.name] = color;\r\n            });\r\n        });\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-color-property\", ColorProperty);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, Expander, img, svg } from \"chili-controls\";\r\nimport { UrlStringConverter } from \"chili-controls/src/converters/urlConverter\";\r\nimport { I18nKeys, IDocument, PathBinding, Property, readFileAsync, Texture } from \"chili-core\";\r\nimport { findPropertyControl } from \"../utils\";\r\nimport style from \"./textureEditor.module.css\";\r\n\r\nexport class TextureProperty extends Expander {\r\n    constructor(\r\n        readonly document: IDocument,\r\n        display: I18nKeys,\r\n        readonly texture: Texture,\r\n    ) {\r\n        super(display);\r\n        this.classList.add(style.root);\r\n        this.append(this.render());\r\n    }\r\n\r\n    private render() {\r\n        const properties = Property.getProperties(this.texture)\r\n            .filter((x) => (x.name as keyof Texture) !== \"image\")\r\n            .map((x) => findPropertyControl(this.document, [this.texture], x));\r\n\r\n        return div(\r\n            { className: style.expander },\r\n            div({ className: style.properties }, ...properties),\r\n            div(\r\n                { className: style.image },\r\n                img({\r\n                    style: {\r\n                        backgroundImage: new PathBinding(this.texture, \"image\", new UrlStringConverter()),\r\n                        backgroundSize: \"contain\",\r\n                    },\r\n                    onclick: this.selectTexture,\r\n                }),\r\n                svg({\r\n                    icon: \"icon-times\",\r\n                    onclick: () => {\r\n                        this.texture.image = \"\";\r\n                    },\r\n                }),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private readonly selectTexture = async () => {\r\n        let file = await readFileAsync(\".png, .jpg, .jpeg\", false, \"readAsDataURL\");\r\n        this.texture.image = file.value[0].data;\r\n    };\r\n}\r\n\r\ncustomElements.define(\"texture-editor\", TextureProperty);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { button, collection, ColorConverter, div, span, UrlStringConverter } from \"chili-controls\";\r\nimport {\r\n    Binding,\r\n    IDocument,\r\n    Localize,\r\n    Material,\r\n    ObservableCollection,\r\n    PathBinding,\r\n    Property,\r\n    PubSub,\r\n    Transaction,\r\n} from \"chili-core\";\r\nimport style from \"./materialProperty.module.css\";\r\nimport { PropertyBase } from \"./propertyBase\";\r\n\r\nexport class MaterialProperty extends PropertyBase {\r\n    private readonly materials: ObservableCollection<Material>;\r\n\r\n    constructor(\r\n        readonly document: IDocument,\r\n        objects: { materialId: string | string[] }[],\r\n        readonly property: Property,\r\n    ) {\r\n        super(objects);\r\n        this.materials = this.materialCollection(objects[0].materialId);\r\n        this.append(\r\n            collection({\r\n                sources: this.materials,\r\n                template: (material, index) => this.materialControl(document, material, index),\r\n            }),\r\n        );\r\n    }\r\n\r\n    private materialControl(document: IDocument, material: Material, index: number) {\r\n        return div(\r\n            { className: style.material },\r\n            div(\r\n                span({ textContent: new Localize(\"common.material\") }),\r\n                this.materials.length > 1 ? span({ textContent: ` ${index + 1}` }) : \"\",\r\n            ),\r\n            button({\r\n                textContent: material.name,\r\n                style: {\r\n                    backgroundColor: new Binding(material, \"color\", new ColorConverter()),\r\n                    backgroundImage: new PathBinding(material, \"map.image\", new UrlStringConverter()),\r\n                    backgroundBlendMode: \"multiply\",\r\n                    backgroundSize: \"cover\",\r\n                    cursor: \"pointer\",\r\n                },\r\n                onclick: (e) => {\r\n                    PubSub.default.pub(\"editMaterial\", document, material, (material) => {\r\n                        this.setMaterial(e, material, index);\r\n                    });\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    private setMaterial(e: MouseEvent, material: Material, index: number) {\r\n        Transaction.execute(this.document, \"change material\", () => {\r\n            this.materials.replace(index, material);\r\n            this.objects.forEach((x) => {\r\n                if (this.property.name in x) {\r\n                    x.materialId =\r\n                        this.materials.length > 1\r\n                            ? x.materialId.toSpliced(index, 1, material.id)\r\n                            : material.id;\r\n                }\r\n            });\r\n        });\r\n        this.document.visual.update();\r\n    }\r\n\r\n    private materialCollection(id: string | string[]) {\r\n        const findMaterial = (id: string) => this.document.materials.find((m) => m.id === id);\r\n        const materials = Array.isArray(id)\r\n            ? id.map(findMaterial).filter(Boolean)\r\n            : [findMaterial(id)].filter(Boolean);\r\n        return new ObservableCollection(...materials) as ObservableCollection<Material>;\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-material-property\", MaterialProperty);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { IConverter, IDocument, Logger, Property, Texture } from \"chili-core\";\r\nimport { CheckProperty } from \"./check\";\r\nimport { ColorProperty } from \"./colorProperty\";\r\nimport { InputProperty } from \"./input\";\r\nimport { TextureProperty } from \"./material/textureEditor\";\r\nimport { MaterialProperty } from \"./materialProperty\";\r\n\r\nexport function findPropertyControl(\r\n    document: IDocument,\r\n    objs: any[],\r\n    prop: Property,\r\n    converter?: IConverter,\r\n) {\r\n    if (prop === undefined || objs.length === 0) return \"\";\r\n\r\n    if (prop.type === \"color\") {\r\n        return new ColorProperty(document, objs, prop);\r\n    }\r\n\r\n    if (prop.type === \"materialId\" && canShowMaterialProperty(objs, prop)) {\r\n        return new MaterialProperty(document, objs, prop);\r\n    }\r\n\r\n    const value = objs[0][prop.name];\r\n    if (value instanceof Texture) {\r\n        return new TextureProperty(document, prop.display, value);\r\n    }\r\n\r\n    if ([\"object\", \"string\", \"number\"].includes(typeof value)) {\r\n        return new InputProperty(document, objs, prop, converter);\r\n    }\r\n\r\n    if (typeof value === \"boolean\") {\r\n        return new CheckProperty(objs, prop);\r\n    }\r\n\r\n    Logger.warn(`Property ${prop.name} not found in ${Object.getPrototypeOf(objs[0]).constructor.name}`);\r\n    return \"\";\r\n}\r\n\r\nfunction canShowMaterialProperty(objs: any[], prop: Property) {\r\n    if (objs.length === 0) return false;\r\n    if (objs.length === 1) return true;\r\n    return objs.every((obj) => obj[prop.name] === objs[0][prop.name]);\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, Expander, label } from \"chili-controls\";\r\nimport {\r\n    FolderNode,\r\n    GroupNode,\r\n    IDocument,\r\n    INode,\r\n    IView,\r\n    Localize,\r\n    Node,\r\n    Property,\r\n    PubSub,\r\n    VisualNode,\r\n} from \"chili-core\";\r\nimport { MatrixProperty } from \"./matrixProperty\";\r\nimport style from \"./propertyView.module.css\";\r\nimport { findPropertyControl } from \"./utils\";\r\n\r\nexport class PropertyView extends HTMLElement {\r\n    private readonly panel = div({ className: style.panel });\r\n\r\n    constructor(props: { className: string }) {\r\n        super();\r\n        this.classList.add(props.className, style.root);\r\n        this.append(\r\n            label({\r\n                className: style.header,\r\n                textContent: new Localize(\"properties.header\"),\r\n            }),\r\n            this.panel,\r\n        );\r\n        PubSub.default.sub(\"showProperties\", this.handleShowProperties);\r\n        PubSub.default.sub(\"activeViewChanged\", this.handleActiveViewChanged);\r\n    }\r\n\r\n    private readonly handleActiveViewChanged = (view: IView | undefined) => {\r\n        if (view) {\r\n            let nodes = view.document.selection.getSelectedNodes();\r\n            this.handleShowProperties(view.document, nodes);\r\n        }\r\n    };\r\n\r\n    private readonly handleShowProperties = (document: IDocument, nodes: INode[]) => {\r\n        this.removeProperties();\r\n        if (nodes.length === 0) return;\r\n        this.addModel(document, nodes);\r\n        this.addGeometry(nodes, document);\r\n    };\r\n\r\n    private removeProperties() {\r\n        while (this.panel.lastElementChild) {\r\n            this.panel.removeChild(this.panel.lastElementChild);\r\n        }\r\n    }\r\n\r\n    private addModel(document: IDocument, nodes: INode[]) {\r\n        if (nodes.length === 0) return;\r\n\r\n        let controls: (HTMLElement | string)[] = [];\r\n        if (nodes[0] instanceof FolderNode) {\r\n            controls = Property.getProperties(Object.getPrototypeOf(nodes[0])).map((x) =>\r\n                findPropertyControl(document, nodes, x),\r\n            );\r\n        } else if (nodes[0] instanceof Node) {\r\n            controls = Property.getOwnProperties(Node.prototype).map((x) =>\r\n                findPropertyControl(document, nodes, x),\r\n            );\r\n        }\r\n\r\n        this.panel.append(div({ className: style.properties }, ...controls));\r\n    }\r\n\r\n    private addGeometry(nodes: INode[], document: IDocument) {\r\n        const geometries = nodes.filter((x) => x instanceof VisualNode || x instanceof GroupNode);\r\n        if (geometries.length === 0 || !this.isAllElementsOfTypeFirstElement(geometries)) return;\r\n        this.addTransform(document, geometries);\r\n        this.addParameters(geometries, document);\r\n    }\r\n\r\n    private addTransform(document: IDocument, geometries: (VisualNode | GroupNode)[]) {\r\n        const matrix = new Expander(\"common.matrix\");\r\n        this.panel.append(matrix);\r\n\r\n        matrix.contenxtPanel.append(new MatrixProperty(document, geometries, style.properties));\r\n    }\r\n\r\n    private addParameters(geometries: (VisualNode | GroupNode)[], document: IDocument) {\r\n        const entities = geometries.filter((x) => x instanceof VisualNode);\r\n        if (entities.length === 0 || !this.isAllElementsOfTypeFirstElement(entities)) return;\r\n        const parameters = new Expander(entities[0].display());\r\n        parameters.contenxtPanel.append(\r\n            ...Property.getProperties(Object.getPrototypeOf(entities[0]), Node.prototype).map((x) =>\r\n                findPropertyControl(document, entities, x),\r\n            ),\r\n        );\r\n        this.panel.append(parameters);\r\n    }\r\n\r\n    private isAllElementsOfTypeFirstElement(arr: any[]): boolean {\r\n        if (arr.length <= 1) {\r\n            return true;\r\n        }\r\n        const firstElementType = Object.getPrototypeOf(arr[0]).constructor;\r\n        for (let i = 1; i < arr.length; i++) {\r\n            if (Object.getPrototypeOf(arr[i]).constructor !== firstElementType) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-property-view\", PropertyView);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { MultistepCommand } from \"chili\";\r\nimport {\r\n    button,\r\n    ColorConverter,\r\n    div,\r\n    input,\r\n    label,\r\n    option,\r\n    select,\r\n    svg,\r\n    UrlStringConverter,\r\n} from \"chili-controls\";\r\nimport {\r\n    Binding,\r\n    CancelableCommand,\r\n    Combobox,\r\n    Command,\r\n    I18n,\r\n    I18nKeys,\r\n    ICommand,\r\n    IDisposable,\r\n    Localize,\r\n    Material,\r\n    Observable,\r\n    PathBinding,\r\n    Property,\r\n    PubSub,\r\n} from \"chili-core\";\r\nimport style from \"./commandContext.module.css\";\r\n\r\nexport class CommandContext extends HTMLElement implements IDisposable {\r\n    private readonly propMap: Map<string | number | symbol, [Property, HTMLElement]> = new Map();\r\n\r\n    constructor(readonly command: ICommand) {\r\n        super();\r\n        this.className = style.panel;\r\n        let data = Command.getData(command);\r\n        this.append(\r\n            svg({ className: style.icon, icon: data!.icon }),\r\n            label({ className: style.title, textContent: new Localize(`command.${data!.key}`) }, `: `),\r\n        );\r\n        this.initContext();\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        if (this.command instanceof Observable) {\r\n            this.command.onPropertyChanged(this.onPropertyChanged);\r\n        }\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        if (this.command instanceof Observable) {\r\n            this.command.removePropertyChanged(this.onPropertyChanged);\r\n        }\r\n    }\r\n\r\n    dispose() {\r\n        this.propMap.clear();\r\n    }\r\n\r\n    private readonly onPropertyChanged = (property: string | number | symbol) => {\r\n        if (this.propMap.has(property)) {\r\n            const [prop, control] = this.propMap.get(property)!;\r\n            this.setVisible(control, prop);\r\n        }\r\n    };\r\n\r\n    private initContext() {\r\n        const groupMap = new Map<I18nKeys, HTMLDivElement>();\r\n        Property.getProperties(this.command).forEach((g) => {\r\n            const group = this.findGroup(groupMap, g);\r\n            const item = this.createItem(this.command, g);\r\n            this.setVisible(item, g);\r\n            this.cacheDependencies(item, g);\r\n            group.append(item);\r\n        });\r\n    }\r\n\r\n    private cacheDependencies(item: HTMLElement, g: Property) {\r\n        if (g.dependencies) {\r\n            for (const d of g.dependencies) {\r\n                this.propMap.set(d.property, [g, item]);\r\n            }\r\n        }\r\n    }\r\n\r\n    private setVisible(control: HTMLElement, property: Property) {\r\n        let visible = true;\r\n        if (property.dependencies) {\r\n            for (const d of property.dependencies) {\r\n                if ((this.command as any)[d.property] !== d.value) {\r\n                    visible = false;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        control.style.display = visible ? \"\" : \"none\";\r\n    }\r\n\r\n    private findGroup(groupMap: Map<I18nKeys, HTMLDivElement>, prop: Property) {\r\n        let group = groupMap.get(prop.group!);\r\n        if (group === undefined) {\r\n            group = div({ className: style.group });\r\n            groupMap.set(prop.group!, group);\r\n            this.append(group);\r\n        }\r\n        return group;\r\n    }\r\n\r\n    private createItem(command: ICommand, g: Property) {\r\n        const noType = command as any;\r\n        const type = typeof noType[g.name];\r\n\r\n        if (g.type === \"materialId\") {\r\n            return this.materialEditor(g, noType);\r\n        }\r\n\r\n        switch (type) {\r\n            case \"function\":\r\n                return this.newButton(g, noType);\r\n            case \"boolean\":\r\n                return this.newCheckbox(g, noType);\r\n            case \"number\":\r\n                return this.newInput(g, noType, parseFloat);\r\n            case \"string\":\r\n                return this.newInput(g, noType);\r\n            default:\r\n                if (noType[g.name] instanceof Combobox) {\r\n                    return this.newCombobox(noType, g);\r\n                }\r\n                throw new Error(\"暂不支持的类型\");\r\n        }\r\n    }\r\n\r\n    private newCombobox(noType: any, g: Property) {\r\n        let combobox = noType[g.name] as Combobox<any>;\r\n        let options = combobox.items.map((item, index) => {\r\n            return option({\r\n                selected: index === combobox.selectedIndex,\r\n                textContent: I18n.isI18nKey(item)\r\n                    ? new Localize(item)\r\n                    : (combobox.converter?.convert(item).unchecked() ?? String(item)),\r\n            });\r\n        });\r\n\r\n        return div(\r\n            label({ textContent: new Localize(g.display) }),\r\n            select(\r\n                {\r\n                    className: style.select,\r\n                    onchange: (e) => {\r\n                        combobox.selectedIndex = (e.target as HTMLSelectElement).selectedIndex;\r\n                    },\r\n                },\r\n                ...options,\r\n            ),\r\n        );\r\n    }\r\n\r\n    private newInput(g: Property, noType: any, converter?: (v: string) => any) {\r\n        return div(\r\n            label({ textContent: new Localize(g.display) }),\r\n            input({\r\n                type: \"text\",\r\n                className: style.input,\r\n                value: new Binding(noType, g.name),\r\n                onkeydown: (e) => {\r\n                    e.stopPropagation();\r\n                    if (e.key === \"Enter\") {\r\n                        const input = e.target as HTMLInputElement;\r\n                        noType[g.name] = converter ? converter(input.value) : input.value;\r\n                        input.blur();\r\n                    }\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    private newCheckbox(g: Property, noType: any) {\r\n        return div(\r\n            label({ textContent: new Localize(g.display) }),\r\n            input({\r\n                type: \"checkbox\",\r\n                checked: new Binding(noType, g.name),\r\n                onclick: () => {\r\n                    noType[g.name] = !noType[g.name];\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    private newButton(g: Property, noType: any) {\r\n        return button({\r\n            className: style.button,\r\n            textContent: new Localize(g.display),\r\n            onclick: () => noType[g.name](),\r\n        });\r\n    }\r\n\r\n    private materialEditor(g: Property, noType: any) {\r\n        if (!(this.command instanceof CancelableCommand)) {\r\n            throw new Error(\"MaterialEditor only support CancelableCommand\");\r\n        }\r\n\r\n        const material = this.command.document.materials.find((x) => x.id === noType[g.name])!;\r\n        const display = material.clone();\r\n\r\n        return button({\r\n            className: style.materialButton,\r\n            style: {\r\n                backgroundColor: new Binding(display, \"color\", new ColorConverter()),\r\n                backgroundImage: new PathBinding(display, \"map.image\", new UrlStringConverter()),\r\n                backgroundBlendMode: \"multiply\",\r\n                backgroundSize: \"cover\",\r\n                cursor: \"pointer\",\r\n            },\r\n            textContent: new Localize(g.display),\r\n            onclick: () => {\r\n                if (this.command instanceof MultistepCommand) {\r\n                    PubSub.default.pub(\"editMaterial\", this.command.document, material, (newMaterial) => {\r\n                        noType[g.name] = newMaterial.id;\r\n                        display.color = newMaterial.color;\r\n                        display.map = newMaterial.map;\r\n                    });\r\n                }\r\n            },\r\n        });\r\n    }\r\n}\r\n\r\ncustomElements.define(\"command-context\", CommandContext);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { label, svg } from \"chili-controls\";\r\nimport {\r\n    ButtonSize,\r\n    Command,\r\n    CommandData,\r\n    CommandKeys,\r\n    I18n,\r\n    I18nKeys,\r\n    IConverter,\r\n    Localize,\r\n    Logger,\r\n    PubSub,\r\n    Result,\r\n} from \"chili-core\";\r\nimport style from \"./ribbonButton.module.css\";\r\n\r\nexport class RibbonButton extends HTMLElement {\r\n    constructor(\r\n        display: I18nKeys,\r\n        icon: string,\r\n        size: ButtonSize,\r\n        readonly onClick: () => void,\r\n    ) {\r\n        super();\r\n        this.initHTML(display, icon, size);\r\n        this.addEventListener(\"click\", onClick);\r\n    }\r\n\r\n    static fromCommandName(commandName: CommandKeys, size: ButtonSize) {\r\n        const data = Command.getData(commandName);\r\n        if (!data) {\r\n            Logger.warn(`commandData of ${commandName} is undefined`);\r\n            return undefined;\r\n        }\r\n        if (data.toggle) {\r\n            return new RibbonToggleButton(data, size);\r\n        }\r\n        return new RibbonButton(`command.${data.key}`, data.icon, size, () => {\r\n            PubSub.default.pub(\"executeCommand\", commandName);\r\n        });\r\n    }\r\n\r\n    dispose(): void {\r\n        this.removeEventListener(\"click\", this.onClick);\r\n    }\r\n\r\n    private initHTML(display: I18nKeys, icon: string, size: ButtonSize) {\r\n        const image = svg({ icon });\r\n        this.className = size === ButtonSize.large ? style.normal : style.small;\r\n        image.classList.add(size === ButtonSize.large ? style.icon : style.smallIcon);\r\n        const text = label({\r\n            className: style.buttonText,\r\n            textContent: new Localize(display),\r\n        });\r\n        I18n.set(this, \"title\", display);\r\n        this.append(image, text);\r\n    }\r\n}\r\n\r\ncustomElements.define(\"ribbon-button\", RibbonButton);\r\n\r\nclass ToggleConverter implements IConverter {\r\n    constructor(\r\n        readonly className: string,\r\n        readonly active: string,\r\n    ) {}\r\n    convert(isChecked: boolean): Result<string, string> {\r\n        return isChecked ? Result.ok(`${this.className} ${this.active}`) : Result.ok(this.className);\r\n    }\r\n}\r\n\r\nexport class RibbonToggleButton extends RibbonButton {\r\n    constructor(data: CommandData, size: ButtonSize) {\r\n        super(`command.${data.key}`, data.icon, size, () => {\r\n            PubSub.default.pub(\"executeCommand\", data.key);\r\n        });\r\n\r\n        if (data.toggle) {\r\n            data.toggle.converter = new ToggleConverter(this.className, style.checked);\r\n            data.toggle.setBinding(this, \"className\");\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(\"ribbon-toggle-button\", RibbonToggleButton);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport style from \"./ribbonStack.module.css\";\r\n\r\nexport class RibbonStack extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        this.className = style.root;\r\n    }\r\n}\r\n\r\ncustomElements.define(\"ribbon-stack\", RibbonStack);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { a, collection, div, label, span, svg } from \"chili-controls\";\r\nimport {\r\n    Binding,\r\n    ButtonSize,\r\n    Command,\r\n    CommandKeys,\r\n    I18n,\r\n    IApplication,\r\n    ICommand,\r\n    IConverter,\r\n    IView,\r\n    Localize,\r\n    Logger,\r\n    Observable,\r\n    ObservableCollection,\r\n    PubSub,\r\n    Result,\r\n} from \"chili-core\";\r\nimport { CommandContext } from \"./commandContext\";\r\nimport style from \"./ribbon.module.css\";\r\nimport { RibbonButton } from \"./ribbonButton\";\r\nimport { RibbonCommandData, RibbonGroupData, RibbonTabData } from \"./ribbonData\";\r\nimport { RibbonStack } from \"./ribbonStack\";\r\n\r\nexport class RibbonDataContent extends Observable {\r\n    readonly quickCommands = new ObservableCollection<CommandKeys>();\r\n    readonly ribbonTabs = new ObservableCollection<RibbonTabData>();\r\n    private _activeTab: RibbonTabData;\r\n    private _activeView: IView | undefined;\r\n\r\n    constructor(\r\n        readonly app: IApplication,\r\n        quickCommands: CommandKeys[],\r\n        ribbonTabs: RibbonTabData[],\r\n    ) {\r\n        super();\r\n        this.quickCommands.push(...quickCommands);\r\n        this.ribbonTabs.push(...ribbonTabs);\r\n        this._activeTab = ribbonTabs[0];\r\n        PubSub.default.sub(\"activeViewChanged\", (v) => (this.activeView = v));\r\n    }\r\n\r\n    get activeTab() {\r\n        return this._activeTab;\r\n    }\r\n    set activeTab(value: RibbonTabData) {\r\n        this.setProperty(\"activeTab\", value);\r\n    }\r\n\r\n    get activeView() {\r\n        return this._activeView;\r\n    }\r\n    set activeView(value: IView | undefined) {\r\n        this.setProperty(\"activeView\", value);\r\n    }\r\n}\r\n\r\nexport const QuickButton = (command: ICommand) => {\r\n    const data = Command.getData(command);\r\n    if (!data) {\r\n        Logger.warn(\"commandData is undefined\");\r\n        return span({ textContent: \"null\" });\r\n    }\r\n\r\n    return svg({\r\n        icon: data.icon,\r\n        title: new Localize(`command.${data.key}`),\r\n        onclick: () => PubSub.default.pub(\"executeCommand\", data.key),\r\n    });\r\n};\r\n\r\nclass ViewActiveConverter implements IConverter<IView> {\r\n    constructor(\r\n        readonly target: IView,\r\n        readonly style: string,\r\n        readonly activeStyle: string,\r\n    ) {}\r\n\r\n    convert(value: IView): Result<string> {\r\n        return Result.ok(this.target === value ? `${this.style} ${this.activeStyle}` : this.style);\r\n    }\r\n}\r\n\r\nclass ActivedRibbonTabConverter implements IConverter<RibbonTabData> {\r\n    constructor(\r\n        readonly tab: RibbonTabData,\r\n        readonly style: string,\r\n        readonly activeStyle: string,\r\n    ) {}\r\n\r\n    convert(value: RibbonTabData): Result<string> {\r\n        return Result.ok(this.tab === value ? `${this.style} ${this.activeStyle}` : this.style);\r\n    }\r\n}\r\n\r\nclass DisplayConverter implements IConverter<RibbonTabData> {\r\n    constructor(readonly tab: RibbonTabData) {}\r\n\r\n    convert(value: RibbonTabData): Result<string> {\r\n        return Result.ok(this.tab === value ? \"\" : \"none\");\r\n    }\r\n}\r\n\r\nexport class Ribbon extends HTMLElement {\r\n    private readonly _commandContext = div({ className: style.commandContextPanel });\r\n    private commandContext?: CommandContext;\r\n\r\n    constructor(readonly dataContent: RibbonDataContent) {\r\n        super();\r\n        this.className = style.root;\r\n        this.append(this.header(), this.ribbonTabs(), this._commandContext);\r\n    }\r\n\r\n    private header() {\r\n        return div({ className: style.titleBar }, this.leftPanel(), this.centerPanel(), this.rightPanel());\r\n    }\r\n\r\n    private leftPanel() {\r\n        return div(\r\n            { className: style.left },\r\n            div(\r\n                { className: style.appIcon, onclick: () => PubSub.default.pub(\"displayHome\", true) },\r\n                svg({ className: style.icon, icon: \"icon-chili\" }),\r\n                span({ id: \"appName\", textContent: `Chili3D - v${__APP_VERSION__}` }),\r\n            ),\r\n            div(\r\n                { className: style.ribbonTitlePanel },\r\n                svg({\r\n                    className: style.home,\r\n                    icon: \"icon-home\",\r\n                    onclick: () => PubSub.default.pub(\"displayHome\", true),\r\n                }),\r\n                collection({\r\n                    className: style.quickCommands,\r\n                    sources: this.dataContent.quickCommands,\r\n                    template: (command: CommandKeys) => QuickButton(command as any),\r\n                }),\r\n                span({ className: style.split }),\r\n                this.createRibbonHeader(),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private createRibbonHeader() {\r\n        return collection({\r\n            sources: this.dataContent.ribbonTabs,\r\n            template: (tab: RibbonTabData) => {\r\n                const converter = new ActivedRibbonTabConverter(tab, style.tabHeader, style.activedTab);\r\n                return label({\r\n                    className: new Binding(this.dataContent, \"activeTab\", converter),\r\n                    textContent: new Localize(tab.tabName),\r\n                    onclick: () => (this.dataContent.activeTab = tab),\r\n                });\r\n            },\r\n        });\r\n    }\r\n\r\n    private centerPanel() {\r\n        return div(\r\n            { className: style.center },\r\n            collection({\r\n                className: style.views,\r\n                sources: this.dataContent.app.views,\r\n                template: (view) => this.createViewItem(view),\r\n            }),\r\n            svg({\r\n                className: style.new,\r\n                icon: \"icon-plus\",\r\n                title: I18n.translate(\"command.doc.new\"),\r\n                onclick: () => PubSub.default.pub(\"executeCommand\", \"doc.new\"),\r\n            }),\r\n        );\r\n    }\r\n\r\n    private createViewItem(view: IView) {\r\n        return div(\r\n            {\r\n                className: new Binding(\r\n                    this.dataContent,\r\n                    \"activeView\",\r\n                    new ViewActiveConverter(view, style.tab, style.active),\r\n                ),\r\n                onclick: () => {\r\n                    this.dataContent.app.activeView = view;\r\n                },\r\n            },\r\n            div({ className: style.name }, span({ textContent: new Binding(view.document, \"name\") })),\r\n            svg({\r\n                className: style.close,\r\n                icon: \"icon-times\",\r\n                onclick: (e) => {\r\n                    e.stopPropagation();\r\n                    view.close();\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    private rightPanel() {\r\n        return div(\r\n            { className: style.right },\r\n            a(\r\n                { href: \"https://github.com/xiangechen/chili3d\", target: \"_blank\" },\r\n                svg({ title: \"Github\", className: style.icon, icon: \"icon-github\" }),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private ribbonTabs() {\r\n        return collection({\r\n            className: style.tabContentPanel,\r\n            sources: this.dataContent.ribbonTabs,\r\n            template: (tab: RibbonTabData) => this.ribbonTab(tab),\r\n        });\r\n    }\r\n\r\n    private ribbonTab(tab: RibbonTabData) {\r\n        return collection({\r\n            className: style.groupPanel,\r\n            sources: tab.groups,\r\n            style: {\r\n                display: new Binding(this.dataContent, \"activeTab\", new DisplayConverter(tab)),\r\n            },\r\n            template: (group: RibbonGroupData) => this.ribbonGroup(group),\r\n        });\r\n    }\r\n\r\n    private ribbonGroup(group: RibbonGroupData) {\r\n        return div(\r\n            { className: style.ribbonGroup },\r\n            collection({\r\n                sources: group.items,\r\n                className: style.content,\r\n                template: (item) => this.ribbonButton(item),\r\n            }),\r\n            label({ className: style.header, textContent: new Localize(group.groupName) }),\r\n        );\r\n    }\r\n\r\n    private ribbonButton(item: RibbonCommandData) {\r\n        if (typeof item === \"string\") {\r\n            return RibbonButton.fromCommandName(item, ButtonSize.large)!;\r\n        } else if (item instanceof ObservableCollection) {\r\n            const stack = new RibbonStack();\r\n            item.forEach((b) => {\r\n                const button = RibbonButton.fromCommandName(b, ButtonSize.small);\r\n                if (button) stack.append(button);\r\n            });\r\n            return stack;\r\n        } else {\r\n            return new RibbonButton(item.display, item.icon, ButtonSize.large, item.onClick);\r\n        }\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        PubSub.default.sub(\"openCommandContext\", this.openContext);\r\n        PubSub.default.sub(\"closeCommandContext\", this.closeContext);\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        PubSub.default.remove(\"openCommandContext\", this.openContext);\r\n        PubSub.default.remove(\"closeCommandContext\", this.closeContext);\r\n    }\r\n\r\n    private readonly openContext = (command: ICommand) => {\r\n        if (this.commandContext) {\r\n            this.closeContext();\r\n        }\r\n        this.commandContext = new CommandContext(command);\r\n        this._commandContext.append(this.commandContext);\r\n    };\r\n\r\n    private readonly closeContext = () => {\r\n        this.commandContext?.remove();\r\n        this.commandContext?.dispose();\r\n        this.commandContext = undefined;\r\n        this._commandContext.innerHTML = \"\";\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-ribbon\", Ribbon);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport {\r\n    Button,\r\n    CommandKeys,\r\n    I18nKeys,\r\n    Observable,\r\n    ObservableCollection,\r\n    RibbonGroup,\r\n    RibbonTab,\r\n} from \"chili-core\";\r\n\r\nexport type RibbonCommandData = CommandKeys | ObservableCollection<CommandKeys> | Button;\r\n\r\nexport class RibbonGroupData extends Observable {\r\n    readonly items: ObservableCollection<RibbonCommandData>;\r\n\r\n    get groupName(): I18nKeys {\r\n        return this.getPrivateValue(\"groupName\");\r\n    }\r\n    set groupName(value: I18nKeys) {\r\n        this.setProperty(\"groupName\", value);\r\n    }\r\n\r\n    constructor(groupName: I18nKeys, ...items: RibbonCommandData[]) {\r\n        super();\r\n        this.setPrivateValue(\"groupName\", groupName);\r\n        this.items = new ObservableCollection<RibbonCommandData>(...items);\r\n    }\r\n\r\n    static fromProfile(profile: RibbonGroup) {\r\n        return new RibbonGroupData(\r\n            profile.groupName,\r\n            ...profile.items.map((item) => {\r\n                return Array.isArray(item) ? new ObservableCollection(...item) : item;\r\n            }),\r\n        );\r\n    }\r\n}\r\n\r\nexport class RibbonTabData extends Observable {\r\n    readonly groups = new ObservableCollection<RibbonGroupData>();\r\n\r\n    get tabName(): I18nKeys {\r\n        return this.getPrivateValue(\"tabName\");\r\n    }\r\n    set tabName(value: I18nKeys) {\r\n        this.setProperty(\"tabName\", value);\r\n    }\r\n\r\n    constructor(tabName: I18nKeys, ...groups: RibbonGroupData[]) {\r\n        super();\r\n        this.setPrivateValue(\"tabName\", tabName);\r\n        this.groups.push(...groups);\r\n    }\r\n\r\n    static fromProfile(profile: RibbonTab) {\r\n        return new RibbonTabData(\r\n            profile.tabName,\r\n            ...profile.groups.map((group) => RibbonGroupData.fromProfile(group)),\r\n        );\r\n    }\r\n}\r\n\r\nexport type RibbonData = RibbonTabData[];\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, input, label } from \"chili-controls\";\r\nimport { Config, I18nKeys, Localize, ObjectSnapType } from \"chili-core\";\r\nimport style from \"./snapConfig.module.css\";\r\n\r\nconst SnapTypes: Array<{\r\n    type: ObjectSnapType;\r\n    display: I18nKeys;\r\n}> = [\r\n    {\r\n        type: ObjectSnapType.endPoint,\r\n        display: \"snap.end\",\r\n    },\r\n    {\r\n        type: ObjectSnapType.midPoint,\r\n        display: \"snap.mid\",\r\n    },\r\n    {\r\n        type: ObjectSnapType.center,\r\n        display: \"snap.center\",\r\n    },\r\n    {\r\n        type: ObjectSnapType.perpendicular,\r\n        display: \"snap.perpendicular\",\r\n    },\r\n    {\r\n        type: ObjectSnapType.intersection,\r\n        display: \"snap.intersection\",\r\n    },\r\n];\r\n\r\nexport class SnapConfig extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        this.className = style.container;\r\n        Config.instance.onPropertyChanged(this.snapTypeChanged);\r\n\r\n        this.render();\r\n    }\r\n\r\n    private readonly snapTypeChanged = (property: keyof Config) => {\r\n        if (property === \"snapType\" || property === \"enableSnap\" || property === \"enableSnapTracking\") {\r\n            this.innerHTML = \"\";\r\n            this.render();\r\n        }\r\n    };\r\n\r\n    private handleSnapClick(snapType: ObjectSnapType) {\r\n        if (ObjectSnapType.has(Config.instance.snapType, snapType)) {\r\n            Config.instance.snapType = ObjectSnapType.remove(Config.instance.snapType, snapType);\r\n        } else {\r\n            Config.instance.snapType = ObjectSnapType.add(Config.instance.snapType, snapType);\r\n        }\r\n    }\r\n\r\n    private render() {\r\n        this.append(\r\n            ...SnapTypes.map((snapType) => {\r\n                return div(\r\n                    input({\r\n                        type: \"checkbox\",\r\n                        id: `snap-${snapType.type}`,\r\n                        checked: ObjectSnapType.has(Config.instance.snapType, snapType.type),\r\n                        onclick: () => this.handleSnapClick(snapType.type),\r\n                    }),\r\n                    label({\r\n                        htmlFor: `snap-${snapType.type}`,\r\n                        textContent: new Localize(snapType.display),\r\n                    }),\r\n                );\r\n            }),\r\n            div(\r\n                input({\r\n                    type: \"checkbox\",\r\n                    id: \"snap-tracking\",\r\n                    checked: Config.instance.enableSnapTracking,\r\n                    onclick: () =>\r\n                        (Config.instance.enableSnapTracking = !Config.instance.enableSnapTracking),\r\n                }),\r\n                label({\r\n                    htmlFor: \"snap-tracking\",\r\n                    textContent: new Localize(\"statusBar.tracking\"),\r\n                }),\r\n            ),\r\n        );\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-snap-config\", SnapConfig);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, label } from \"chili-controls\";\r\nimport { I18n, I18nKeys, Localize, PubSub } from \"chili-core\";\r\nimport { SnapConfig } from \"./snapConfig\";\r\nimport style from \"./statusbar.module.css\";\r\n\r\nexport class Statusbar extends HTMLElement {\r\n    readonly tip = label({\r\n        textContent: new Localize(\"prompt.default\"),\r\n        className: style.tip,\r\n    });\r\n\r\n    constructor(className: string) {\r\n        super();\r\n        this.className = `${style.panel} ${className}`;\r\n\r\n        PubSub.default.sub(\"statusBarTip\", this.statusBarTip);\r\n        PubSub.default.sub(\"clearStatusBarTip\", this.clearStatusBarTip);\r\n\r\n        this.render();\r\n    }\r\n\r\n    private render() {\r\n        this.append(\r\n            div({ className: style.left }, this.tip),\r\n            div({ className: style.right }, new SnapConfig()),\r\n        );\r\n    }\r\n\r\n    private readonly statusBarTip = (tip: I18nKeys) => {\r\n        I18n.set(this.tip, \"textContent\", tip);\r\n    };\r\n\r\n    private readonly clearStatusBarTip = () => {\r\n        I18n.set(this.tip, \"textContent\", \"prompt.default\");\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-statusbar\", Statusbar);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { CursorType } from \"chili-core\";\r\nimport draw from \"./draw.cur\";\r\n\r\nconst cursors: Map<CursorType, string> = new Map([\r\n    [\"default\", \"default\"],\r\n    [\"draw\", `url(${draw}), default`],\r\n    [\"select.default\", \"crosshair\"],\r\n]);\r\n\r\nexport namespace Cursor {\r\n    export function get(type: CursorType) {\r\n        return cursors.get(type) ?? \"default\";\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { IDocument, Material, Observable } from \"chili-core\";\r\n\r\nlet count = 1;\r\n\r\nexport class MaterialDataContent extends Observable {\r\n    get editingMaterial(): Material {\r\n        return this.getPrivateValue(\"editingMaterial\");\r\n    }\r\n    set editingMaterial(value: Material) {\r\n        this.setProperty(\"editingMaterial\", value);\r\n    }\r\n\r\n    constructor(\r\n        readonly document: IDocument,\r\n        readonly callback: (material: Material) => void,\r\n        editingMaterial: Material,\r\n    ) {\r\n        super();\r\n        this.setPrivateValue(\"editingMaterial\", editingMaterial);\r\n    }\r\n\r\n    deleteMaterial() {\r\n        if (this.document.materials.length <= 1) return;\r\n        let tempMaterial = this.editingMaterial;\r\n        this.editingMaterial = this.document.materials.find((m) => m.id !== this.editingMaterial.id)!;\r\n        this.callback(this.editingMaterial);\r\n        this.document.materials.remove(tempMaterial);\r\n    }\r\n\r\n    addMaterial() {\r\n        this.document.materials.push(new Material(this.document, `Material ${count++}`, 0xdddddd));\r\n    }\r\n\r\n    copyMaterial() {\r\n        this.document.materials.push(this.editingMaterial.clone());\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { button, collection, ColorConverter, div, span, svg } from \"chili-controls\";\r\nimport { UrlStringConverter } from \"chili-controls/src/converters/urlConverter\";\r\nimport {\r\n    Binding,\r\n    IConverter,\r\n    Localize,\r\n    Material,\r\n    PathBinding,\r\n    Property,\r\n    PubSub,\r\n    Result,\r\n    Texture,\r\n} from \"chili-core\";\r\nimport { findPropertyControl } from \"../utils\";\r\nimport { MaterialDataContent } from \"./materialDataContent\";\r\nimport style from \"./materialEditor.module.css\";\r\n\r\nclass ActiveStyleConverter implements IConverter<Material> {\r\n    constructor(readonly material: Material) {}\r\n\r\n    convert(value: Material): Result<string> {\r\n        return Result.ok(this.material === value ? `${style.material} ${style.active}` : style.material);\r\n    }\r\n}\r\n\r\nexport class MaterialEditor extends HTMLElement {\r\n    private readonly editingControl: HTMLElement;\r\n    private readonly colorConverter = new ColorConverter();\r\n\r\n    constructor(readonly dataContent: MaterialDataContent) {\r\n        super();\r\n        this.editingControl = div({ className: style.properties });\r\n        this.initEditingControl(dataContent.editingMaterial);\r\n        this.append(this.createEditorUI());\r\n    }\r\n\r\n    private createEditorUI() {\r\n        return div(\r\n            { className: style.root },\r\n            this.titleSection(),\r\n            this.materialsCollection(),\r\n            this.editingControl,\r\n            this.buttons(),\r\n        );\r\n    }\r\n\r\n    private titleSection() {\r\n        return div(\r\n            { className: style.title },\r\n            span({ textContent: new Localize(\"common.material\") }),\r\n            this.iconButton(\"icon-plus\", () => this.dataContent.addMaterial()),\r\n            this.iconButton(\"icon-clone\", () => this.dataContent.copyMaterial()),\r\n            this.iconButton(\"icon-trash\", () => this.dataContent.deleteMaterial()),\r\n        );\r\n    }\r\n\r\n    private iconButton(icon: string, onclick: () => void) {\r\n        return svg({ icon, onclick });\r\n    }\r\n\r\n    private materialsCollection() {\r\n        return collection({\r\n            className: style.materials,\r\n            sources: this.dataContent.document.materials,\r\n            template: (material: Material) => this.material(material),\r\n        });\r\n    }\r\n\r\n    private material(material: Material) {\r\n        return span({\r\n            className: new Binding(this.dataContent, \"editingMaterial\", new ActiveStyleConverter(material)),\r\n            title: material.name,\r\n            style: {\r\n                backgroundColor: new Binding(material, \"color\", this.colorConverter),\r\n                backgroundImage: new PathBinding(material, \"map.image\", new UrlStringConverter()),\r\n                backgroundBlendMode: \"multiply\",\r\n                backgroundSize: \"contain\",\r\n            },\r\n            onclick: () => {\r\n                this.dataContent.editingMaterial = material;\r\n            },\r\n            ondblclick: () => {\r\n                this.dataContent.callback(material);\r\n                this.remove();\r\n            },\r\n        });\r\n    }\r\n\r\n    private buttons() {\r\n        return div(\r\n            { className: style.bottom },\r\n            button({\r\n                textContent: new Localize(\"common.confirm\"),\r\n                onclick: () => {\r\n                    this.dataContent.callback(this.dataContent.editingMaterial);\r\n                    this.remove();\r\n                },\r\n            }),\r\n            button({\r\n                textContent: new Localize(\"common.cancel\"),\r\n                onclick: () => this.remove(),\r\n            }),\r\n        );\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.dataContent.onPropertyChanged(this._onEditingMaterialChanged);\r\n        PubSub.default.sub(\"showProperties\", this._handleShowProperty);\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        PubSub.default.remove(\"showProperties\", this._handleShowProperty);\r\n    }\r\n\r\n    private readonly _handleShowProperty = () => {\r\n        this.remove();\r\n    };\r\n\r\n    private readonly _onEditingMaterialChanged = (property: keyof MaterialDataContent) => {\r\n        if (property !== \"editingMaterial\") return;\r\n        this.editingControl.firstChild?.remove();\r\n        this.initEditingControl(this.dataContent.editingMaterial);\r\n    };\r\n\r\n    private initEditingControl(material: Material) {\r\n        this.editingControl.innerHTML = \"\";\r\n\r\n        const isTexture = (p: Property) => {\r\n            return (material as any)[p.name] instanceof Texture;\r\n        };\r\n\r\n        let properties = Property.getProperties(material);\r\n        this.editingControl.append(\r\n            ...properties\r\n                .filter((x) => !isTexture(x))\r\n                .map((x) => findPropertyControl(this.dataContent.document, [material], x)),\r\n            ...properties\r\n                .filter(isTexture)\r\n                .map((x) => findPropertyControl(this.dataContent.document, [material], x)),\r\n        );\r\n    }\r\n}\r\n\r\ncustomElements.define(\"material-editor\", MaterialEditor);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, span, svg } from \"chili-controls\";\r\nimport { AsyncController, I18nKeys, Localize } from \"chili-core\";\r\nimport style from \"./okCancel.module.css\";\r\n\r\nexport class OKCancel extends HTMLElement {\r\n    private control?: AsyncController;\r\n\r\n    constructor() {\r\n        super();\r\n        this.className = style.root;\r\n        this.append(this.container());\r\n    }\r\n\r\n    private container() {\r\n        return div(\r\n            { className: style.container },\r\n            span({ textContent: new Localize(\"ribbon.group.selection\") }),\r\n            div({ className: style.spacer }),\r\n            this.buttons(),\r\n        );\r\n    }\r\n\r\n    private buttons() {\r\n        return div(\r\n            { className: style.panel },\r\n            this._createIcon(\"icon-confirm\", \"common.confirm\", this._onConfirm),\r\n            this._createIcon(\"icon-cancel\", \"common.cancel\", this._onCancel),\r\n        );\r\n    }\r\n\r\n    private _createIcon(icon: string, text: I18nKeys, onClick: () => void) {\r\n        return div(\r\n            {\r\n                className: style.icon,\r\n                onclick: onClick,\r\n            },\r\n            svg({ icon }),\r\n            span({ textContent: new Localize(text) }),\r\n        );\r\n    }\r\n\r\n    setControl(control: AsyncController | undefined) {\r\n        this.control = control;\r\n    }\r\n\r\n    private readonly _onConfirm = () => {\r\n        this.control?.success();\r\n    };\r\n\r\n    private readonly _onCancel = () => {\r\n        this.control?.cancel();\r\n    };\r\n}\r\n\r\ncustomElements.define(\"ok-cancel\", OKCancel);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { input, label } from \"chili-controls\";\r\nimport { I18n, I18nKeys, IDisposable, Localize, Result } from \"chili-core\";\r\nimport style from \"./input.module.css\";\r\n\r\nexport class Input extends HTMLElement implements IDisposable {\r\n    private readonly _cancelledCallbacks: (() => void)[] = [];\r\n    private readonly _completedCallbacks: (() => void)[] = [];\r\n    private readonly textbox: HTMLInputElement;\r\n    private tip?: HTMLLabelElement;\r\n\r\n    constructor(\r\n        text: string,\r\n        readonly handler: (text: string) => Result<string, I18nKeys>,\r\n    ) {\r\n        super();\r\n        this.className = style.panel;\r\n        this.textbox = input({\r\n            value: text,\r\n            onkeydown: this.handleKeyDown,\r\n        });\r\n        this.append(this.textbox);\r\n    }\r\n\r\n    onCancelled(callback: () => void) {\r\n        this._cancelledCallbacks.push(callback);\r\n    }\r\n\r\n    onCompleted(callback: () => void) {\r\n        this._completedCallbacks.push(callback);\r\n    }\r\n\r\n    get text(): string {\r\n        return this.textbox.value;\r\n    }\r\n\r\n    override focus() {\r\n        this.textbox.focus();\r\n    }\r\n\r\n    dispose() {\r\n        this._cancelledCallbacks.length = 0;\r\n        this._completedCallbacks.length = 0;\r\n    }\r\n\r\n    private showTip(tip: I18nKeys) {\r\n        if (this.tip === undefined) {\r\n            this.tip = label({\r\n                textContent: new Localize(tip),\r\n                className: style.error,\r\n            });\r\n            this.append(this.tip);\r\n        } else {\r\n            I18n.set(this.tip, \"textContent\", tip);\r\n        }\r\n    }\r\n\r\n    private removeTip() {\r\n        if (this.tip === undefined) return;\r\n        this.removeChild(this.tip);\r\n        this.tip = undefined;\r\n    }\r\n\r\n    private readonly handleKeyDown = (e: KeyboardEvent) => {\r\n        e.stopPropagation();\r\n        if (e.key === \"Enter\") {\r\n            this.processEnterKey();\r\n        } else if (e.key === \"Escape\") {\r\n            this._cancelledCallbacks.forEach((callback) => callback());\r\n        } else {\r\n            this.removeTip();\r\n        }\r\n    };\r\n\r\n    private processEnterKey() {\r\n        this.textbox.readOnly = true;\r\n        const error = this.handler(this.textbox.value);\r\n        if (error.isOk) {\r\n            this._completedCallbacks.forEach((callback) => callback());\r\n        } else {\r\n            this.textbox.readOnly = false;\r\n            this.showTip(error.error);\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-input\", Input);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { MessageType } from \"chili-core\";\r\nimport style from \"./tip.module.css\";\r\n\r\nexport class Tip extends HTMLElement {\r\n    private color?: string;\r\n\r\n    constructor(msg: string, type: MessageType) {\r\n        super();\r\n        this.className = style.tip;\r\n        this.set(msg, type);\r\n    }\r\n\r\n    set(msg: string, type: MessageType) {\r\n        if (this.textContent !== msg) {\r\n            this.textContent = msg;\r\n        }\r\n\r\n        let newStyle = this.getStyle(type);\r\n        this.setStyle(newStyle);\r\n    }\r\n\r\n    private setStyle(newStyle: string) {\r\n        if (this.color !== newStyle && newStyle !== undefined) {\r\n            if (this.color !== undefined) this.classList.remove(this.color);\r\n            this.classList.add(newStyle);\r\n            this.color = newStyle;\r\n        }\r\n    }\r\n\r\n    private getStyle(type: MessageType) {\r\n        switch (type) {\r\n            case MessageType.error:\r\n                return style.error;\r\n            case MessageType.warn:\r\n                return style.warn;\r\n            default:\r\n                return style.info;\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-tip\", Tip);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { I18nKeys, MessageType, PubSub, Result } from \"chili-core\";\r\nimport style from \"./flyout.module.css\";\r\nimport { Input } from \"./input\";\r\nimport { Tip } from \"./tip\";\r\n\r\nexport class Flyout extends HTMLElement {\r\n    private _tip: Tip | undefined;\r\n    private _input: Input | undefined;\r\n    private lastFocus: HTMLElement | null = null;\r\n\r\n    constructor() {\r\n        super();\r\n        this.className = style.root;\r\n    }\r\n\r\n    connectedCallback(): void {\r\n        PubSub.default.sub(\"showFloatTip\", this.showTip);\r\n        PubSub.default.sub(\"clearFloatTip\", this.clearTip);\r\n        PubSub.default.sub(\"showInput\", this.displayInput);\r\n        PubSub.default.sub(\"clearInput\", this.clearInput);\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        PubSub.default.remove(\"showFloatTip\", this.showTip);\r\n        PubSub.default.remove(\"clearFloatTip\", this.clearTip);\r\n        PubSub.default.remove(\"showInput\", this.displayInput);\r\n        PubSub.default.remove(\"clearInput\", this.clearInput);\r\n    }\r\n\r\n    private readonly showTip = (level: MessageType, msg: string) => {\r\n        if (this._tip === undefined) {\r\n            this._tip = new Tip(msg, level);\r\n            this.append(this._tip);\r\n        } else {\r\n            this._tip.set(msg, level);\r\n        }\r\n    };\r\n\r\n    private readonly clearTip = () => {\r\n        if (this._tip !== undefined) {\r\n            this._tip.remove();\r\n            this._tip = undefined;\r\n        }\r\n    };\r\n\r\n    private readonly displayInput = (text: string, handler: (text: string) => Result<string, I18nKeys>) => {\r\n        if (this._input === undefined) {\r\n            this.lastFocus = document.activeElement as HTMLElement;\r\n            this._input = new Input(text, handler);\r\n            this._input.onCancelled(this.clearInput);\r\n            this._input.onCompleted(this.clearInput);\r\n            this.append(this._input);\r\n            this._input.focus();\r\n        }\r\n    };\r\n\r\n    private readonly clearInput = () => {\r\n        if (this._input !== undefined) {\r\n            this.removeChild(this._input);\r\n            this._input.dispose();\r\n            this._input = undefined;\r\n            this.lastFocus?.focus();\r\n        }\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-flyout\", Flyout);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { collection, div, input, label, span, svg } from \"chili-controls\";\r\nimport {\r\n    Act,\r\n    Binding,\r\n    CameraType,\r\n    DialogResult,\r\n    IConverter,\r\n    IView,\r\n    Localize,\r\n    PubSub,\r\n    Result,\r\n} from \"chili-core\";\r\nimport { Flyout } from \"./flyout\";\r\nimport style from \"./viewport.module.css\";\r\n\r\nclass CameraConverter implements IConverter<CameraType> {\r\n    constructor(readonly type: CameraType) {}\r\n\r\n    convert(value: CameraType): Result<string, string> {\r\n        if (value === this.type) {\r\n            return Result.ok(style.actived);\r\n        }\r\n        return Result.ok(\"\");\r\n    }\r\n}\r\n\r\nexport class Viewport extends HTMLElement {\r\n    private readonly _flyout: Flyout;\r\n    private readonly _eventCaches: [keyof HTMLElementEventMap, (e: any) => void][] = [];\r\n    private readonly _acts: HTMLElement;\r\n\r\n    constructor(readonly view: IView) {\r\n        super();\r\n        this.className = style.root;\r\n        this._flyout = new Flyout();\r\n        this._acts = this.createActs();\r\n        this.render();\r\n        view.setDom(this);\r\n    }\r\n\r\n    private readonly onActCollectionChanged = () => {\r\n        if (this.view.document.acts.length === 0) {\r\n            this._acts.style.display = \"none\";\r\n        } else {\r\n            this._acts.style.display = \"flex\";\r\n        }\r\n    };\r\n\r\n    private render() {\r\n        this.append(\r\n            this._acts,\r\n            div(\r\n                {\r\n                    className: style.viewControls,\r\n                    onpointerdown: (ev) => ev.stopPropagation(),\r\n                    onclick: (e) => e.stopPropagation(),\r\n                },\r\n                this.createCameraControls(),\r\n                this.createActionControls(),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private createCameraControls() {\r\n        return div(\r\n            { className: style.border },\r\n            this.createCameraControl(\"orthographic\", \"icon-orthographic\"),\r\n            this.createCameraControl(\"perspective\", \"icon-perspective\"),\r\n        );\r\n    }\r\n\r\n    private createActionControls() {\r\n        return div(\r\n            { className: style.border },\r\n            svg({\r\n                icon: \"icon-fitcontent\",\r\n                onclick: async (e) => {\r\n                    e.stopPropagation();\r\n                    this.view.cameraController.fitContent();\r\n                    this.view.update();\r\n                },\r\n            }),\r\n            svg({\r\n                icon: \"icon-zoomin\",\r\n                onclick: () => {\r\n                    this.view.cameraController.zoom(this.view.width / 2, this.view.height / 2, -5);\r\n                    this.view.update();\r\n                },\r\n            }),\r\n            svg({\r\n                icon: \"icon-zoomout\",\r\n                onclick: () => {\r\n                    this.view.cameraController.zoom(this.view.width / 2, this.view.height / 2, 5);\r\n                    this.view.update();\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    private createActs() {\r\n        return div(\r\n            { className: style.actsContainer },\r\n            div(\r\n                {\r\n                    className: style.border,\r\n                    onpointerdown: (ev) => ev.stopPropagation(),\r\n                    onclick: (e) => e.stopPropagation(),\r\n                },\r\n                collection({\r\n                    className: style.acts,\r\n                    sources: this.view.document.acts,\r\n                    template: (v) => {\r\n                        return div(\r\n                            {\r\n                                onclick: () => {\r\n                                    this.view.cameraController.lookAt(\r\n                                        v.cameraPosition,\r\n                                        v.cameraTarget,\r\n                                        v.cameraUp,\r\n                                    );\r\n                                    this.view.update();\r\n                                },\r\n                            },\r\n                            span({\r\n                                textContent: new Binding(v, \"name\"),\r\n                            }),\r\n                            div(\r\n                                {\r\n                                    className: style.tools,\r\n                                },\r\n                                svg({\r\n                                    icon: \"icon-cog\",\r\n                                    onclick: () => this.setActName(v),\r\n                                }),\r\n                                svg({\r\n                                    icon: \"icon-times\",\r\n                                    onclick: () => {\r\n                                        this.view.document.acts.remove(v);\r\n                                    },\r\n                                }),\r\n                            ),\r\n                        );\r\n                    },\r\n                    onwheel: (e) => {\r\n                        e.preventDefault();\r\n                        const container = e.currentTarget as HTMLElement;\r\n                        container.scrollLeft += e.deltaY;\r\n                    },\r\n                }),\r\n            ),\r\n        );\r\n    }\r\n\r\n    private readonly setActName = (act: Act) => {\r\n        const inputBox = input({\r\n            value: act.name,\r\n            onkeydown: (e) => {\r\n                e.stopPropagation();\r\n            },\r\n        });\r\n        PubSub.default.pub(\r\n            \"showDialog\",\r\n            \"ribbon.group.act\",\r\n            div(label({ textContent: new Localize(\"common.name\") }), \": \", inputBox),\r\n            (result) => {\r\n                if (result === DialogResult.ok) {\r\n                    act.name = inputBox.value;\r\n                }\r\n            },\r\n        );\r\n    };\r\n\r\n    private createCameraControl(cameraType: CameraType, icon: string) {\r\n        return div(\r\n            {\r\n                className: new Binding(\r\n                    this.view.cameraController,\r\n                    \"cameraType\",\r\n                    new CameraConverter(cameraType),\r\n                ),\r\n            },\r\n            svg({\r\n                icon: icon,\r\n                onclick: (e) => {\r\n                    e.stopPropagation();\r\n                    this.view.cameraController.cameraType = cameraType;\r\n                    this.view.update();\r\n                },\r\n            }),\r\n        );\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.initEvent();\r\n        this.appendChild(this._flyout);\r\n        this.view.document.acts.onCollectionChanged(this.onActCollectionChanged);\r\n        this.onActCollectionChanged();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.removeEvents();\r\n        this._flyout.remove();\r\n        this.view.document.acts.removeCollectionChanged(this.onActCollectionChanged);\r\n    }\r\n\r\n    dispose() {\r\n        this.removeEvents();\r\n    }\r\n\r\n    private initEvent() {\r\n        let events: [keyof HTMLElementEventMap, (view: IView, e: any) => any][] = [\r\n            [\"pointerdown\", this.pointerDown],\r\n            [\"pointermove\", this.pointerMove],\r\n            [\"pointerout\", this.pointerOut],\r\n            [\"pointerup\", this.pointerUp],\r\n            [\"wheel\", this.mouseWheel],\r\n        ];\r\n        events.forEach((v) => {\r\n            this.addEventListenerHandler(v[0], v[1]);\r\n        });\r\n    }\r\n\r\n    private addEventListenerHandler(type: keyof HTMLElementEventMap, handler: (view: IView, e: any) => any) {\r\n        let listener = (e: any) => {\r\n            e.preventDefault();\r\n            handler(this.view, e);\r\n        };\r\n        this.addEventListener(type, listener);\r\n        this._eventCaches.push([type, listener]);\r\n    }\r\n\r\n    private removeEvents() {\r\n        this._eventCaches.forEach((x) => {\r\n            this.removeEventListener(x[0], x[1]);\r\n        });\r\n        this._eventCaches.length = 0;\r\n    }\r\n\r\n    private readonly pointerMove = (view: IView, event: PointerEvent) => {\r\n        if (this._flyout) {\r\n            this._flyout.style.top = event.offsetY + \"px\";\r\n            this._flyout.style.left = event.offsetX + \"px\";\r\n        }\r\n        view.document.visual.eventHandler.pointerMove(view, event);\r\n        view.document.visual.viewHandler.pointerMove(view, event);\r\n    };\r\n\r\n    private readonly pointerDown = (view: IView, event: PointerEvent) => {\r\n        view.document.application.activeView = view;\r\n        view.document.visual.eventHandler.pointerDown(view, event);\r\n        view.document.visual.viewHandler.pointerDown(view, event);\r\n    };\r\n\r\n    private readonly pointerUp = (view: IView, event: PointerEvent) => {\r\n        view.document.visual.eventHandler.pointerUp(view, event);\r\n        view.document.visual.viewHandler.pointerUp(view, event);\r\n    };\r\n\r\n    private readonly pointerOut = (view: IView, event: PointerEvent) => {\r\n        view.document.visual.eventHandler.pointerOut?.(view, event);\r\n        view.document.visual.viewHandler.pointerOut?.(view, event);\r\n    };\r\n\r\n    private readonly mouseWheel = (view: IView, event: WheelEvent) => {\r\n        view.document.visual.eventHandler.mouseWheel?.(view, event);\r\n        view.document.visual.viewHandler.mouseWheel?.(view, event);\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-uiview\", Viewport);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport {\r\n    AsyncController,\r\n    CollectionAction,\r\n    CollectionChangedArgs,\r\n    CursorType,\r\n    IApplication,\r\n    IDocument,\r\n    IView,\r\n    Material,\r\n    PubSub,\r\n} from \"chili-core\";\r\nimport { Cursor } from \"../cursor\";\r\nimport { MaterialEditor } from \"../property/material\";\r\nimport { MaterialDataContent } from \"../property/material/materialDataContent\";\r\nimport style from \"./layoutViewport.module.css\";\r\nimport { OKCancel } from \"./okCancel\";\r\nimport { Viewport } from \"./viewport\";\r\n\r\nexport class LayoutViewport extends HTMLElement {\r\n    private readonly _selectionController: OKCancel;\r\n    private readonly _viewports: Map<IView, Viewport> = new Map();\r\n\r\n    constructor(readonly app: IApplication) {\r\n        super();\r\n        this.className = style.root;\r\n        this._selectionController = new OKCancel();\r\n        this.append(this._selectionController);\r\n        this.clearSelectionControl();\r\n        app.views.onCollectionChanged(this._handleViewCollectionChanged);\r\n    }\r\n\r\n    private readonly _handleViewCollectionChanged = (args: CollectionChangedArgs) => {\r\n        if (args.action === CollectionAction.add) {\r\n            args.items.forEach((view) => {\r\n                this.createViewport(view);\r\n            });\r\n        } else if (args.action === CollectionAction.remove) {\r\n            args.items.forEach((view) => {\r\n                let viewport = this._viewports.get(view);\r\n                viewport?.remove();\r\n                viewport?.dispose();\r\n                this._viewports.delete(view);\r\n            });\r\n        }\r\n    };\r\n\r\n    connectedCallback(): void {\r\n        PubSub.default.sub(\"activeViewChanged\", this._handleActiveViewChanged);\r\n        PubSub.default.sub(\"showSelectionControl\", this.showSelectionControl);\r\n        PubSub.default.sub(\"editMaterial\", this._handleMaterialEdit);\r\n        PubSub.default.sub(\"clearSelectionControl\", this.clearSelectionControl);\r\n        PubSub.default.sub(\"viewCursor\", this._handleCursor);\r\n    }\r\n\r\n    disconnectedCallback(): void {\r\n        PubSub.default.remove(\"activeViewChanged\", this._handleActiveViewChanged);\r\n        PubSub.default.remove(\"showSelectionControl\", this.showSelectionControl);\r\n        PubSub.default.remove(\"editMaterial\", this._handleMaterialEdit);\r\n        PubSub.default.remove(\"clearSelectionControl\", this.clearSelectionControl);\r\n        PubSub.default.remove(\"viewCursor\", this._handleCursor);\r\n    }\r\n\r\n    private readonly _handleCursor = (type: CursorType) => {\r\n        this.style.cursor = Cursor.get(type);\r\n    };\r\n\r\n    private createViewport(view: IView) {\r\n        let viewport = new Viewport(view);\r\n        viewport.classList.add(style.viewport, style.hidden);\r\n        this.appendChild(viewport);\r\n        this._viewports.set(view, viewport);\r\n        return viewport;\r\n    }\r\n\r\n    private readonly _handleActiveViewChanged = (view: IView | undefined) => {\r\n        this._viewports.forEach((v) => {\r\n            if (v.view === view) {\r\n                v.classList.remove(style.hidden);\r\n            } else {\r\n                v.classList.add(style.hidden);\r\n            }\r\n        });\r\n    };\r\n\r\n    private readonly showSelectionControl = (controller: AsyncController) => {\r\n        this._selectionController.setControl(controller);\r\n        this._selectionController.style.visibility = \"visible\";\r\n        this._selectionController.style.zIndex = \"1000\";\r\n    };\r\n\r\n    private readonly clearSelectionControl = () => {\r\n        this._selectionController.setControl(undefined);\r\n        this._selectionController.style.visibility = \"hidden\";\r\n    };\r\n\r\n    private readonly _handleMaterialEdit = (\r\n        document: IDocument,\r\n        editingMaterial: Material,\r\n        callback: (material: Material) => void,\r\n    ) => {\r\n        let context = new MaterialDataContent(document, callback, editingMaterial);\r\n        this.append(new MaterialEditor(context));\r\n    };\r\n}\r\n\r\ncustomElements.define(\"chili-viewport\", LayoutViewport);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div } from \"chili-controls\";\r\nimport { Button, CommandKeys, I18nKeys, IApplication, RibbonTab } from \"chili-core\";\r\nimport style from \"./editor.module.css\";\r\nimport { ProjectView } from \"./project\";\r\nimport { PropertyView } from \"./property\";\r\nimport { Ribbon, RibbonDataContent } from \"./ribbon\";\r\nimport { RibbonTabData } from \"./ribbon/ribbonData\";\r\nimport { Statusbar } from \"./statusbar\";\r\nimport { LayoutViewport } from \"./viewport\";\r\n\r\nlet quickCommands: CommandKeys[] = [\"doc.save\", \"doc.saveToFile\", \"edit.undo\", \"edit.redo\"];\r\n\r\nexport class Editor extends HTMLElement {\r\n    readonly ribbonContent: RibbonDataContent;\r\n\r\n    constructor(app: IApplication, tabs: RibbonTab[]) {\r\n        super();\r\n        const viewport = new LayoutViewport(app);\r\n        viewport.classList.add(style.viewport);\r\n\r\n        this.ribbonContent = new RibbonDataContent(app, quickCommands, tabs.map(RibbonTabData.fromProfile));\r\n\r\n        this.render(viewport);\r\n        document.body.appendChild(this);\r\n    }\r\n\r\n    private render(viewport: LayoutViewport) {\r\n        this.append(\r\n            div(\r\n                { className: style.root },\r\n                new Ribbon(this.ribbonContent),\r\n                div(\r\n                    { className: style.content },\r\n                    div(\r\n                        { className: style.sidebar },\r\n                        new ProjectView({ className: style.sidebarItem }),\r\n                        new PropertyView({ className: style.sidebarItem }),\r\n                    ),\r\n                    viewport,\r\n                ),\r\n                new Statusbar(style.statusbar),\r\n            ),\r\n        );\r\n    }\r\n\r\n    registerRibbonCommand(tabName: I18nKeys, groupName: I18nKeys, command: CommandKeys | Button) {\r\n        const tab = this.ribbonContent.ribbonTabs.find((p) => p.tabName === tabName);\r\n        const group = tab?.groups.find((p) => p.groupName === groupName);\r\n        group?.items.push(command);\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-editor\", Editor);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { HTMLProps, option, select } from \"chili-controls\";\r\nimport { I18n } from \"chili-core\";\r\n\r\nexport const LanguageSelector = (props: HTMLProps<HTMLElement>) => {\r\n    let languages: HTMLOptionElement[] = [];\r\n    I18n.languages.forEach((language, index) =>\r\n        languages.push(\r\n            option({\r\n                selected: index === I18n.currentLanguage(),\r\n                textContent: language.display,\r\n            }),\r\n        ),\r\n    );\r\n    return select(\r\n        {\r\n            onchange: (e) => {\r\n                let language = (e.target as HTMLSelectElement).selectedIndex;\r\n                I18n.changeLanguage(language);\r\n            },\r\n            ...props,\r\n        },\r\n        ...languages,\r\n    );\r\n};\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { a, button, collection, div, img, label, span, svg } from \"chili-controls\";\r\nimport {\r\n    Constants,\r\n    I18n,\r\n    I18nKeys,\r\n    IApplication,\r\n    Localize,\r\n    ObservableCollection,\r\n    PubSub,\r\n    RecentDocumentDTO,\r\n} from \"chili-core\";\r\nimport style from \"./home.module.css\";\r\nimport { LanguageSelector } from \"./languageSelector\";\r\n\r\ninterface ApplicationCommand {\r\n    display: I18nKeys;\r\n    icon?: string;\r\n    onclick: () => void;\r\n}\r\n\r\nconst applicationCommands = new ObservableCollection<ApplicationCommand>(\r\n    {\r\n        display: \"command.doc.new\",\r\n        onclick: () => PubSub.default.pub(\"executeCommand\", \"doc.new\"),\r\n    },\r\n    {\r\n        display: \"command.doc.open\",\r\n        onclick: () => PubSub.default.pub(\"executeCommand\", \"doc.open\"),\r\n    },\r\n);\r\n\r\nexport class Home extends HTMLElement {\r\n    constructor(readonly app: IApplication) {\r\n        super();\r\n        this.className = style.root;\r\n    }\r\n\r\n    private hasOpen(documentId: string) {\r\n        for (const document of this.app.documents) {\r\n            if (document.id === documentId) return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    private async getDocuments() {\r\n        return new ObservableCollection(\r\n            ...(await this.app.storage.page(Constants.DBName, Constants.RecentTable, 0)),\r\n        );\r\n    }\r\n\r\n    async render() {\r\n        const documents = await this.getDocuments();\r\n        this.append(\r\n            this.leftSection(),\r\n            this.rightSection(documents),\r\n            LanguageSelector({ className: style.language }),\r\n        );\r\n        document.body.appendChild(this);\r\n    }\r\n\r\n    private leftSection() {\r\n        return div(\r\n            { className: style.left },\r\n            div(\r\n                { className: style.top },\r\n                this.logoSection(),\r\n                this.applicationCommands(),\r\n                this.currentDocument(),\r\n            ),\r\n            this.links(),\r\n        );\r\n    }\r\n\r\n    private logoSection() {\r\n        return div(\r\n            { className: style.logo },\r\n            svg({ icon: \"icon-chili\" }),\r\n            span({ textContent: \"CHILI3D\" }),\r\n            span({ className: style.version, textContent: __APP_VERSION__ }),\r\n        );\r\n    }\r\n\r\n    private applicationCommands() {\r\n        return collection({\r\n            className: style.buttons,\r\n            sources: applicationCommands,\r\n            template: (item) =>\r\n                button({\r\n                    className: style.button,\r\n                    textContent: new Localize(item.display),\r\n                    onclick: item.onclick,\r\n                }),\r\n        });\r\n    }\r\n\r\n    private currentDocument() {\r\n        return this.app.activeView?.document\r\n            ? button({\r\n                  className: `${style.button} ${style.back}`,\r\n                  textContent: new Localize(\"common.back\"),\r\n                  onclick: () => {\r\n                      PubSub.default.pub(\"displayHome\", false);\r\n                  },\r\n              })\r\n            : \"\";\r\n    }\r\n\r\n    private links() {\r\n        return div(\r\n            { className: style.bottom },\r\n            a({\r\n                textContent: \"Github\",\r\n                href: \"https://github.com/xiangechen/chili3d\",\r\n                target: \"_blank\",\r\n            }),\r\n        );\r\n    }\r\n\r\n    private rightSection(documents: ObservableCollection<RecentDocumentDTO>) {\r\n        return div(\r\n            { className: style.right },\r\n            label({ className: style.welcome, textContent: new Localize(\"home.welcome\") }),\r\n            div({ className: style.recent, textContent: new Localize(\"home.recent\") }),\r\n            this.documentCollection(documents),\r\n        );\r\n    }\r\n\r\n    private documentCollection(documents: ObservableCollection<RecentDocumentDTO>) {\r\n        return collection({\r\n            className: style.documents,\r\n            sources: documents,\r\n            template: (item) => this.recentDocument(item, documents),\r\n        });\r\n    }\r\n\r\n    private recentDocument(item: RecentDocumentDTO, documents: ObservableCollection<RecentDocumentDTO>) {\r\n        return div(\r\n            {\r\n                className: style.document,\r\n                onclick: () => this.handleDocumentClick(item),\r\n            },\r\n            img({ className: style.img, src: item.image }),\r\n            this.documentDescription(item),\r\n            this.deleteIcon(item, documents),\r\n        );\r\n    }\r\n\r\n    private documentDescription(item: RecentDocumentDTO) {\r\n        return div(\r\n            { className: style.description },\r\n            span({ className: style.title, textContent: item.name }),\r\n            span({\r\n                className: style.date,\r\n                textContent: new Date(item.date).toLocaleDateString(),\r\n            }),\r\n        );\r\n    }\r\n\r\n    private deleteIcon(item: RecentDocumentDTO, documents: ObservableCollection<RecentDocumentDTO>) {\r\n        return svg({\r\n            className: style.delete,\r\n            icon: \"icon-times\",\r\n            onclick: async (e) => {\r\n                e.stopPropagation();\r\n                if (window.confirm(I18n.translate(\"prompt.deleteDocument{0}\", item.name))) {\r\n                    await Promise.all([\r\n                        this.app.storage.delete(Constants.DBName, Constants.DocumentTable, item.id),\r\n                        this.app.storage.delete(Constants.DBName, Constants.RecentTable, item.id),\r\n                    ]);\r\n                    documents.remove(item);\r\n                }\r\n            },\r\n        });\r\n    }\r\n\r\n    private handleDocumentClick(item: RecentDocumentDTO) {\r\n        if (this.hasOpen(item.id)) {\r\n            PubSub.default.pub(\"displayHome\", false);\r\n        } else {\r\n            PubSub.default.pub(\r\n                \"showPermanent\",\r\n                async () => {\r\n                    let document = await this.app.openDocument(item.id);\r\n                    document?.application.activeView?.cameraController.fitContent();\r\n                },\r\n                \"toast.excuting{0}\",\r\n                I18n.translate(\"command.doc.open\"),\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\ncustomElements.define(\"chili-home\", Home);\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { div, span } from \"chili-controls\";\r\nimport { I18n, I18nKeys } from \"chili-core\";\r\nimport style from \"./permanent.module.css\";\r\n\r\nexport class Permanent {\r\n    static async show(action: () => Promise<void>, message: I18nKeys, ...args: any[]) {\r\n        let dialog = document.createElement(\"dialog\");\r\n        dialog.appendChild(\r\n            div(\r\n                { className: style.container },\r\n                div({\r\n                    className: style.loading,\r\n                    style: {\r\n                        animation: `${style.circle} infinite 0.75s linear`,\r\n                    },\r\n                }),\r\n                span({\r\n                    className: style.message,\r\n                    textContent: I18n.translate(message, ...args),\r\n                }),\r\n            ),\r\n        );\r\n        document.body.appendChild(dialog);\r\n        dialog.showModal();\r\n\r\n        action().finally(() => dialog.remove());\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport { I18n, I18nKeys } from \"chili-core\";\r\nimport { label } from \"chili-controls\";\r\nimport style from \"./toast.module.css\";\r\n\r\nexport class Toast {\r\n    private static _lastToast: [number, HTMLElement] | undefined;\r\n\r\n    static readonly info = (message: I18nKeys, ...args: any[]) => {\r\n        Toast.display(style.info, I18n.translate(message, ...args));\r\n    };\r\n\r\n    static readonly error = (message: string) => {\r\n        Toast.display(style.error, message);\r\n    };\r\n\r\n    static readonly warn = (message: string) => {\r\n        Toast.display(style.warning, message);\r\n    };\r\n\r\n    private static display(type: string, message: string) {\r\n        if (this._lastToast) {\r\n            clearTimeout(this._lastToast[0]);\r\n            this._lastToast[1].remove();\r\n        }\r\n\r\n        const toast = label({ className: `${style.toast} ${type}`, textContent: message });\r\n        document.body.appendChild(toast);\r\n        this._lastToast = [\r\n            window.setTimeout(() => {\r\n                toast.remove();\r\n                this._lastToast = undefined;\r\n            }, 2000),\r\n            toast,\r\n        ];\r\n    }\r\n}\r\n","// Part of the Chili3d Project, under the AGPL-3.0 License.\r\n// See LICENSE file in the project root for full license information.\r\n\r\nimport {\r\n    Button,\r\n    CommandKeys,\r\n    I18nKeys,\r\n    IApplication,\r\n    IWindow,\r\n    PubSub,\r\n    RibbonTab,\r\n    debounce,\r\n} from \"chili-core\";\r\nimport { Dialog } from \"./dialog\";\r\nimport { Editor } from \"./editor\";\r\nimport { Home } from \"./home\";\r\nimport { Permanent } from \"./permanent\";\r\nimport { Toast } from \"./toast\";\r\n\r\ndocument.oncontextmenu = (e) => e.preventDefault();\r\ndocument.body.addEventListener(\"scroll\", (e) => {\r\n    document.body.scrollTop = 0;\r\n});\r\n\r\nexport class MainWindow implements IWindow {\r\n    private _inited: boolean = false;\r\n    private _home?: Home;\r\n    private _editor?: Editor;\r\n\r\n    constructor(readonly tabs: RibbonTab[]) {\r\n        this.setTheme(\"light\");\r\n    }\r\n\r\n    init(app: IApplication) {\r\n        if (this._inited) {\r\n            throw new Error(\"MainWindow is already inited\");\r\n        }\r\n        this._inited = true;\r\n        this._initHome(app);\r\n        this._initEditor(app);\r\n        this._initSubs(app);\r\n    }\r\n\r\n    private _initSubs(app: IApplication) {\r\n        const displayHome = debounce(this.displayHome, 100);\r\n        PubSub.default.sub(\"showToast\", Toast.info);\r\n        PubSub.default.sub(\"displayError\", Toast.error);\r\n        PubSub.default.sub(\"showDialog\", Dialog.show);\r\n        PubSub.default.sub(\"showPermanent\", Permanent.show);\r\n        PubSub.default.sub(\"activeViewChanged\", (view) => displayHome(app, view === undefined));\r\n        PubSub.default.sub(\"displayHome\", (show) => displayHome(app, show));\r\n    }\r\n\r\n    private readonly displayHome = (app: IApplication, displayHome: boolean) => {\r\n        if (this._home) {\r\n            this._home.remove();\r\n            this._home = undefined;\r\n        }\r\n        if (displayHome) {\r\n            this._initHome(app);\r\n        }\r\n    };\r\n\r\n    private async _initHome(app: IApplication) {\r\n        this._home = new Home(app);\r\n        await this._home.render();\r\n    }\r\n\r\n    private async _initEditor(app: IApplication) {\r\n        this._editor = new Editor(app, this.tabs);\r\n    }\r\n\r\n    registerHomeCommand(groupName: I18nKeys, command: CommandKeys | Button): void {\r\n        throw new Error(\"Method not implemented.\");\r\n    }\r\n\r\n    registerRibbonCommand(tabName: I18nKeys, groupName: I18nKeys, command: CommandKeys | Button) {\r\n        this._editor?.registerRibbonCommand(tabName, groupName, command);\r\n    }\r\n\r\n    setTheme(theme: \"light\" | \"dark\") {\r\n        document.documentElement.setAttribute(\"theme\", theme);\r\n    }\r\n}\r\n"],"names":["Dialog","title","content","callback","dialog","document","div","style","I18n","button","DialogResult","TreeItem","HTMLElement","node","property","model","setSVGIcon","e","Transaction","label","Binding","svg","parentVisible","TreeGroup","value","nodes","child","items","item","referenceNode","customElements","ToolBar","projectView","PubSub","buttons","icon","tip","command","a","expand","tree","first","list","INode","TreeModel","Tree","Map","Set","selected","unselected","x","undefined","event","isLinkList","newParent","target","records","record","ele","parent","pre","group","element","firstChild","result","VisualNode","Error","NodeSelectionHandler","ShapeSelectionHandler","ShapeType","ProjectView","props","span","Localize","view","PropertyBase","objects","ArrayValueConverter","converter","Result","obj","cvalue","String","values","uniqueValues","InputProperty","input","newValue","arrayConverter","commonStyle","des","Object","proto","isPropertyChanged","name","converters","XYZ","XYZConverter","XY","XYConverter","StringConverter","Number","NumberConverter","MatrixProperty","geometries","className","TranslationConverter","ScalingConverter","RotateConverter","MatrixConverter","geometry","y","z","isNaN","matrix","position","rotation","scale","Matrix4","s","translation","Math","CheckProperty","ColorProperty","ColorConverter","color","object","colorStyle","TextureProperty","Expander","display","texture","file","readFileAsync","properties","Property","findPropertyControl","img","PathBinding","UrlStringConverter","MaterialProperty","collection","material","index","id","findMaterial","m","materials","Array","Boolean","ObservableCollection","objs","prop","canShowMaterialProperty","Texture","Logger","PropertyView","controls","FolderNode","Node","GroupNode","entities","parameters","arr","firstElementType","i","CommandContext","control","data","Command","Observable","groupMap","g","d","visible","type","noType","parseFloat","Combobox","combobox","options","option","select","CancelableCommand","MultistepCommand","newMaterial","RibbonButton","size","onClick","commandName","RibbonToggleButton","image","ButtonSize","text","ToggleConverter","active","isChecked","RibbonStack","RibbonDataContent","app","quickCommands","ribbonTabs","v","QuickButton","ViewActiveConverter","activeStyle","ActivedRibbonTabConverter","tab","DisplayConverter","Ribbon","dataContent","stack","b","RibbonGroupData","groupName","profile","RibbonTabData","tabName","groups","SnapTypes","ObjectSnapType","SnapConfig","Config","snapType","Statusbar","cursors","Cursor","get","count","MaterialDataContent","editingMaterial","tempMaterial","Material","ActiveStyleConverter","MaterialEditor","onclick","isTexture","p","OKCancel","Input","handler","error","Tip","msg","newStyle","MessageType","Flyout","level","CameraConverter","Viewport","act","inputBox","ev","container","cameraType","events","listener","LayoutViewport","args","CollectionAction","viewport","controller","context","Editor","tabs","LanguageSelector","languages","language","applicationCommands","Home","documentId","document1","Constants","documents","__APP_VERSION__","Date","window","Promise","Permanent","action","message","Toast","clearTimeout","toast","MainWindow","displayHome","debounce","show","theme"],"mappings":"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"}